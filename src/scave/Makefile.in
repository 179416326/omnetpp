#
# Definitions to be customized by 'configure'
#
CXX=@CXX@
YACC=@YACC@
LEX=@LEX@
AR=@AR@
RANLIB=@RANLIB@
SHLIB_LD=@SHLIB_LD@
MAKEDEPEND=@MAKEDEPEND@
DOXYGEN=@DOXYGEN@
CPPFLAGS=@CPPFLAGS@
CFLAGS=@CFLAGS@
XML_CFLAGS=@XML_CFLAGS@

OMNETPP_INCL_DIR=@OMNETPP_INCL_DIR@
OMNETPP_LIB_DIR=@OMNETPP_LIB_DIR@

OMNETPP_VERSION=@OMNETPP_VERSION@
OMNETPP_EDITION=@OMNETPP_EDITION@


# LIB_SUFFIX is either A_LIB_SUFFIX or SO_LIB_SUFFIX
LIB_SUFFIX=@LIB_SUFFIX@

A_LIB_SUFFIX=@A_LIB_SUFFIX@
SO_LIB_SUFFIX=@SO_LIB_SUFFIX@

XMLPARSER=@XMLPARSER@

#
# Local definitions
#
COPTS=$(CFLAGS) $(XML_CFLAGS) -I. -I../common

OBJS= arraybuilder.o channel.o commonnodes.o compoundfilter.o \
      dataflowmanager.o datasorter.o diffquot.o \
      filewriter.o filternodes.o stddev.o \
      idlist.o mergernodes.o nodetype.o nodetyperegistry.o \
      resultfilemanager.o slidingwinavg.o \
      vectorfilereader.o vectorfilewriter.o windowavg.o \
      xyplotnode.o octaveexport.o

#
# Automatic rules
#
.SUFFIXES : .cc

.cc.o:
	$(CXX) -c $(COPTS) -o $@ $<

#
# Targets
#
default : scavelib

scavelib : libscave$(LIB_SUFFIX)

libscave$(A_LIB_SUFFIX): $(OBJS)
	$(AR) libscave$(A_LIB_SUFFIX) $(OBJS)
	$(RANLIB) libscave$(A_LIB_SUFFIX)
	../utils/install-lib libscave$(A_LIB_SUFFIX).$(OMNETPP_VERSION) $(OMNETPP_LIB_DIR) libscave$(A_LIB_SUFFIX)

libscave$(SO_LIB_SUFFIX) : $(OBJS)
	$(SHLIB_LD) -o libscave$(SO_LIB_SUFFIX) $(OBJS)
	../utils/install-lib libscave$(SO_LIB_SUFFIX).$(OMNETPP_VERSION) $(OMNETPP_LIB_DIR) libscave$(SO_LIB_SUFFIX)

depend:
	$(MAKEDEPEND) -I. -I../common -- *.cc
	$(MAKEDEPEND) -I. -I../common -fMakefile.in -- *.cc

doc:
	# NOTE: doxy.cfg has the output directory hardcoded!
	$(DOXYGEN) doxy.cfg

clean:
	rm -f *.o
	rm -f libscave$(A_LIB_SUFFIX) libscave$(SO_LIB_SUFFIX)

# DO NOT DELETE THIS LINE -- make depend depends on it.
arraybuilder.o: arraybuilder.cc \
  channel.h \
  arraybuilder.h \
  ../common/util.h \
  node.h \
  ../common/exception.h \
  scavedefs.h \
  commonnodes.h \
  xyarray.h \
  nodetype.h \
  dataflowmanager.h
channel.o: channel.cc \
  channel.h \
  ../common/util.h \
  node.h \
  ../common/exception.h \
  scavedefs.h
commonnodes.o: commonnodes.cc \
  commonnodes.h \
  channel.h \
  node.h \
  nodetype.h \
  scavedefs.h \
  ../common/util.h \
  ../common/exception.h \
  dataflowmanager.h
compoundfilter.o: compoundfilter.cc \
  ../common/util.h \
  compoundfilter.h \
  filternodes.h \
  nodetyperegistry.h \
  ../common/exception.h \
  nodetype.h \
  commonnodes.h \
  dataflowmanager.h \
  node.h \
  channel.h \
  scavedefs.h
dataflowmanager.o: dataflowmanager.cc \
  channel.h \
  nodetype.h \
  dataflowmanager.h \
  ../common/util.h \
  node.h \
  ../common/exception.h \
  scavedefs.h
datasorter.o: datasorter.cc \
  resultfilemanager.h \
  ../common/util.h \
  datasorter.h \
  idlist.h \
  ../common/exception.h \
  scavedefs.h \
  ../common/patternmatcher.h
diffquot.o: diffquot.cc \
  channel.h \
  diffquot.h \
  ../common/util.h \
  node.h \
  ../common/exception.h \
  scavedefs.h \
  commonnodes.h \
  nodetype.h \
  dataflowmanager.h
filewriter.o: filewriter.cc \
  channel.h \
  filewriter.h \
  ../common/util.h \
  node.h \
  ../common/exception.h \
  scavedefs.h \
  commonnodes.h \
  nodetype.h \
  dataflowmanager.h
filternodes.o: filternodes.cc \
  channel.h \
  filternodes.h \
  ../common/util.h \
  node.h \
  ../common/exception.h \
  scavedefs.h \
  commonnodes.h \
  nodetype.h \
  dataflowmanager.h
idlist.o: idlist.cc \
  idlist.h \
  resultfilemanager.h \
  scavedefs.h \
  ../common/exception.h \
  ../common/util.h
ivectorfilereader.o: ivectorfilereader.cc \
  ../common/exception.h \
  ../common/linetokenizer.h \
  ivectorfilereader.h \
  ../common/filereader.h
mergernodes.o: mergernodes.cc \
  channel.h \
  mergernodes.h \
  ../common/util.h \
  node.h \
  ../common/exception.h \
  scavedefs.h \
  commonnodes.h \
  nodetype.h \
  dataflowmanager.h
nodetype.o: nodetype.cc \
  ../common/util.h \
  nodetype.h \
  ../common/exception.h \
  dataflowmanager.h \
  node.h \
  channel.h \
  scavedefs.h
nodetyperegistry.o: nodetyperegistry.cc \
  ../common/util.h \
  nodetyperegistry.h \
  ../common/stringtokenizer.h \
  arraybuilder.h \
  vectorfilereader.h \
  vectorfilewriter.h \
  filewriter.h \
  windowavg.h \
  slidingwinavg.h \
  filternodes.h \
  mergernodes.h \
  xyplotnode.h \
  diffquot.h \
  stddev.h \
  ../common/exception.h \
  node.h \
  nodetype.h \
  scavedefs.h \
  dataflowmanager.h \
  channel.h \
  commonnodes.h \
  xyarray.h \
  ../common/filetokenizer.h
octaveexport.o: octaveexport.cc \
  octaveexport.h \
  scavedefs.h \
  xyarray.h \
  ../common/exception.h
resultfilemanager.o: resultfilemanager.cc \
  ../common/patternmatcher.h \
  resultfilemanager.h \
  ../common/filetokenizer.h \
  ../common/stringtokenizer.h \
  idlist.h \
  ../common/exception.h \
  ../common/util.h \
  scavedefs.h
scavetool.o: scavetool.cc \
  ../utils/ver.h \
  resultfilemanager.h \
  nodetype.h \
  nodetyperegistry.h \
  dataflowmanager.h \
  vectorfilereader.h \
  vectorfilewriter.h \
  filternodes.h \
  filewriter.h \
  arraybuilder.h \
  octaveexport.h \
  idlist.h \
  ../common/exception.h \
  ../common/util.h \
  scavedefs.h \
  node.h \
  channel.h \
  ../common/filetokenizer.h \
  commonnodes.h \
  xyarray.h
slidingwinavg.o: slidingwinavg.cc \
  channel.h \
  slidingwinavg.h \
  ../common/util.h \
  node.h \
  ../common/exception.h \
  scavedefs.h \
  commonnodes.h \
  nodetype.h \
  dataflowmanager.h
stddev.o: stddev.cc \
  channel.h \
  stddev.h \
  ../common/util.h \
  node.h \
  ../common/exception.h \
  scavedefs.h \
  commonnodes.h \
  xyarray.h \
  nodetype.h \
  dataflowmanager.h
vectorfilereader.o: vectorfilereader.cc \
  channel.h \
  vectorfilereader.h \
  ../common/util.h \
  node.h \
  ../common/exception.h \
  scavedefs.h \
  nodetype.h \
  ../common/filetokenizer.h \
  dataflowmanager.h
vectorfilewriter.o: vectorfilewriter.cc \
  channel.h \
  vectorfilewriter.h \
  ../common/util.h \
  node.h \
  ../common/exception.h \
  scavedefs.h \
  nodetype.h \
  dataflowmanager.h
windowavg.o: windowavg.cc \
  channel.h \
  windowavg.h \
  ../common/util.h \
  node.h \
  ../common/exception.h \
  scavedefs.h \
  commonnodes.h \
  nodetype.h \
  dataflowmanager.h
xyplotnode.o: xyplotnode.cc \
  channel.h \
  xyplotnode.h \
  ../common/util.h \
  node.h \
  ../common/exception.h \
  scavedefs.h \
  commonnodes.h \
  nodetype.h \
  dataflowmanager.h
