#
# Definitions to be customized by 'configure'
#
CXX=@CXX@
AR=@AR@
MAKE_SO=@MAKE_SO@

CFLAGS=@CFLAGS@

OMNETPP_ROOT=@OMNETPP_ROOT@
OMNETPP_SRC_DIR=@OMNETPP_SRC_DIR@
OMNETPP_INCL_PATH=@OMNETPP_INCL_PATH@
OMNETPP_BITMAP_PATH=@OMNETPP_BITMAP_PATH@

TK_INCL_PATH=@TK_INCL_PATH@

LIB_SUFFIX=@LIB_SUFFIX@

#
# Local definitions
#
ENVIR_INCL_PATH=-I../envir

COPTS=-fwritable-strings $(CFLAGS) $(OMNETPP_INCL_PATH) $(ENVIR_INCL_PATH) $(TK_INCL_PATH)

OMNETPP_TKENV_DIR=$(OMNETPP_SRC_DIR)/tkenv

OBJS = $(TKAPP).o tkcmd.o tklib.o objinsp.o modinsp.o statinsp.o inspect.o arrow.o

# Standalone executable support: you can have Tkenv's TCL script parts
# be compiled into the executable. Enable doing so, uncomment the
# TKAPP=tkapp-rt line below. Otherwise, uncomment TKAPP=tkapp.
#
TKAPP=tkapp
#TKAPP=tkapp-rt

#
# Targets
#
default: @TKENV_IF_POSSIBLE@

tkenv : libtkenv.$(LIB_SUFFIX)

libtkenv.a : $(OBJS)
	$(AR) libtkenv.a $(OBJS)

libtkenv.so : $(OBJS)
	$(MAKE_SO) libtkenv.so $(OBJS)

tkapp.o : tkapp.cc
	$(CXX) -c $(COPTS) -DOMNETPP_TKENV_DIR=\"$(OMNETPP_TKENV_DIR)\" -DOMNETPP_BITMAP_PATH=\"$(OMNETPP_BITMAP_PATH)\" tkapp.cc

tkapp-rt.o : tkapp.cc  tclcode.cc
	$(CXX) -c $(COPTS) -DOMNETPP_BITMAP_PATH=\"$(OMNETPP_BITMAP_PATH)\" tkapp.cc -o tkapp-rt.o

tkcmd.o : tkcmd.cc
	$(CXX) -c $(COPTS) tkcmd.cc

tklib.o : tklib.cc
	$(CXX) -c $(COPTS) tklib.cc

objinsp.o: objinsp.cc
	$(CXX) -c $(COPTS) objinsp.cc

modinsp.o: modinsp.cc
	$(CXX) -c $(COPTS) modinsp.cc

statinsp.o: statinsp.cc
	$(CXX) -c $(COPTS) statinsp.cc

inspect.o: inspect.cc
	$(CXX) -c $(COPTS) inspect.cc

arrow.o: arrow.cc arrow.h
	$(CXX) -c $(COPTS) arrow.cc

tclcode.cc: *.tcl tcl2c
	./tcl2c tclcode.cc *.tcl

tcl2c: tcl2c.c
	$(CC) tcl2c.c -o tcl2c

missing-library:
	echo '*** No Tk installation found -- skipping TKEnv'

depend:
	makedepend -Y -I. -I../envir -I../sim -- *.cc
	makedepend -Y -I. -I../envir -I../sim -fmakefile.in -- *.cc

clean:
	rm -f *.o libtkenv.a libtkenv.so tcl2c


# DO NOT DELETE THIS LINE -- make depend depends on it.


