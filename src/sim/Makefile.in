#
# Definitions to be customized by 'configure'
#
CXX=@CXX@
AS=@AS@
AR=@AR@
RANLIB=@RANLIB@
SHLIB_LD=@SHLIB_LD@
MAKEDEPEND=@MAKEDEPEND@

CFLAGS=@CFLAGS@

OMNETPP_INCL_DIR=@OMNETPP_INCL_DIR@
OMNETPP_LIB_DIR=@OMNETPP_LIB_DIR@
OMNETPP_VERSION=@OMNETPP_VERSION@

MPI_CFLAGS=@MPI_CFLAGS@
PVM_CFLAGS=@PVM_CFLAGS@

# LIB_SUFFIX is either A_LIB_SUFFIX or SO_LIB_SUFFIX
LIB_SUFFIX=@LIB_SUFFIX@

A_LIB_SUFFIX=@A_LIB_SUFFIX@
SO_LIB_SUFFIX=@SO_LIB_SUFFIX@

#
# Local definitions
#
COPTS=$(CFLAGS) -I$(OMNETPP_INCL_DIR) -I. -Istd -Ipvm -DBUILDING_SIM

CPPOBJS= ccor.o ctypes.o carray.o cgate.o cmodule.o csimul.o cobject.o cpar.o \
	 cstat.o chist.o cdensity.o cvarhist.o cpsquare.o cksplit.o \
         cmessage.o cdetect.o cstk.o util.o cllist.o ctopo.o errmsg.o \
	 cmsgheap.o cnetmod.o coutvect.o cqueue.o chead.o cwatch.o \
         cpacket.o cfsm.o cenum.o cstruct.o
CPPOBJS_STD= std/netpack.o
CPPOBJS_MPI= mpi/mpimod.o mpi/mpipack.o
CPPOBJS_PVM= pvm/pvmmod.o pvm/pvmpack.o
ASMOBJS=
# ASMOBJS=stjpower.o swpower.o	   # uncomment this on RS/6000

#
# Targets
#
default : sim_std @SIM_PVM_IF_POSSIBLE@ @SIM_MPI_IF_POSSIBLE@

sim_std : libsim_std$(LIB_SUFFIX)

sim_mpi : libsim_mpi$(LIB_SUFFIX)

sim_pvm : libsim_pvm$(LIB_SUFFIX)

libsim_std$(A_LIB_SUFFIX) : $(CPPOBJS) $(CPPOBJS_STD) $(ASMOBJS)
	$(AR) libsim_std$(A_LIB_SUFFIX) $(CPPOBJS) $(CPPOBJS_STD) $(ASMOBJS)
	$(RANLIB) libsim_std$(A_LIB_SUFFIX)
	../utils/install-lib libsim_std$(A_LIB_SUFFIX).$(OMNETPP_VERSION) $(OMNETPP_LIB_DIR) libsim_std$(A_LIB_SUFFIX)

libsim_std$(SO_LIB_SUFFIX) : $(CPPOBJS) $(CPPOBJS_STD) $(ASMOBJS)
	$(SHLIB_LD) -o libsim_std$(SO_LIB_SUFFIX) $(CPPOBJS) $(CPPOBJS_STD) $(ASMOBJS)
	../utils/install-lib libsim_std$(SO_LIB_SUFFIX).$(OMNETPP_VERSION) $(OMNETPP_LIB_DIR) libsim_std$(SO_LIB_SUFFIX)

libsim_mpi$(A_LIB_SUFFIX) : $(CPPOBJS) $(CPPOBJS_MPI) $(ASMOBJS)
	$(AR) libsim_mpi$(A_LIB_SUFFIX) $(CPPOBJS) $(CPPOBJS_MPI) $(ASMOBJS)
	$(RANLIB) libsim_mpi$(A_LIB_SUFFIX)
	../utils/install-lib libsim_mpi$(A_LIB_SUFFIX).$(OMNETPP_VERSION) $(OMNETPP_LIB_DIR) libsim_mpi$(A_LIB_SUFFIX)

libsim_mpi$(SO_LIB_SUFFIX) : $(CPPOBJS) $(CPPOBJS_MPI) $(ASMOBJS)
	$(SHLIB_LD) -o libsim_mpi$(SO_LIB_SUFFIX) $(CPPOBJS) $(CPPOBJS_MPI) $(ASMOBJS)
	../utils/install-lib libsim_mpi$(SO_LIB_SUFFIX).$(OMNETPP_VERSION) $(OMNETPP_LIB_DIR) libsim_mpi$(SO_LIB_SUFFIX)

libsim_pvm$(A_LIB_SUFFIX) : $(CPPOBJS) $(CPPOBJS_PVM) $(ASMOBJS)
	$(AR) libsim_pvm$(A_LIB_SUFFIX) $(CPPOBJS) $(CPPOBJS_PVM) $(ASMOBJS)
	$(RANLIB) libsim_pvm$(A_LIB_SUFFIX)
	../utils/install-lib libsim_pvm$(A_LIB_SUFFIX).$(OMNETPP_VERSION) $(OMNETPP_LIB_DIR) libsim_pvm$(A_LIB_SUFFIX)

libsim_pvm$(SO_LIB_SUFFIX) : $(CPPOBJS) $(CPPOBJS_PVM) $(ASMOBJS)
	$(SHLIB_LD) -o libsim_pvm$(SO_LIB_SUFFIX) $(CPPOBJS) $(CPPOBJS_PVM) $(ASMOBJS)
	../utils/install-lib libsim_pvm$(SO_LIB_SUFFIX).$(OMNETPP_VERSION) $(OMNETPP_LIB_DIR) libsim_pvm$(SO_LIB_SUFFIX)

ccor.o : ccor.cc
	$(CXX) -c $(COPTS) ccor.cc

ctypes.o : ctypes.cc
	$(CXX) -c $(COPTS) ctypes.cc

carray.o : carray.cc
	$(CXX) -c $(COPTS) carray.cc

cqueue.o : cqueue.cc
	$(CXX) -c $(COPTS) cqueue.cc

chead.o : chead.cc
	$(CXX) -c $(COPTS) chead.cc

cwatch.o : cwatch.cc
	$(CXX) -c $(COPTS) cwatch.cc

cmodule.o : cmodule.cc
	$(CXX) -c $(COPTS) cmodule.cc

csimul.o : csimul.cc
	$(CXX) -c $(COPTS) csimul.cc

cgate.o : cgate.cc
	$(CXX) -c $(COPTS) cgate.cc

cmessage.o : cmessage.cc
	$(CXX) -c $(COPTS) cmessage.cc

cpacket.o : cpacket.cc
	$(CXX) -c $(COPTS) cpacket.cc

cfsm.o : cfsm.cc
	$(CXX) -c $(COPTS) cfsm.cc

cobject.o : cobject.cc
	$(CXX) -c $(COPTS) cobject.cc

cpar.o : cpar.cc
	$(CXX) -c $(COPTS) cpar.cc

cstat.o : cstat.cc
	$(CXX) -c $(COPTS) cstat.cc

cdensity.o : cdensity.cc
	$(CXX) -c $(COPTS) cdensity.cc

chist.o : chist.cc
	$(CXX) -c $(COPTS) chist.cc

cvarhist.o : cvarhist.cc
	$(CXX) -c $(COPTS) cvarhist.cc

cdetect.o : cdetect.cc
	$(CXX) -c $(COPTS) cdetect.cc

cpsquare.o : cpsquare.cc
	$(CXX) -c $(COPTS) cpsquare.cc

cksplit.o : cksplit.cc
	$(CXX) -c $(COPTS) cksplit.cc

cmsgheap.o : cmsgheap.cc
	$(CXX) -c $(COPTS) cmsgheap.cc

cnetmod.o : cnetmod.cc
	$(CXX) -c $(COPTS) cnetmod.cc

cllist.o : cllist.cc
	$(CXX) -c $(COPTS) cllist.cc

ctopo.o : ctopo.cc
	$(CXX) -c $(COPTS) ctopo.cc

coutvect.o : coutvect.cc
	$(CXX) -c $(COPTS) coutvect.cc

cstk.o : cstk.cc
	$(CXX) -c $(COPTS) cstk.cc

cenum.o : cenum.cc
	$(CXX) -c $(COPTS) cenum.cc

cstruct.o : cstruct.cc
	$(CXX) -c $(COPTS) cstruct.cc

util.o : util.cc
	$(CXX) -c $(COPTS) util.cc

errmsg.o : errmsg.cc
	$(CXX) -c $(COPTS) errmsg.cc

stjpower.o : stjpower.s
	$(AS) stjpower.s

swpower.o : swpower.s
	$(AS) swpower.s

std/netpack.o : std/netpack.cc
	$(CXX) -c $(COPTS) std/netpack.cc -o std/netpack.o

mpi/mpipack.o : mpi/mpipack.cc
	$(CXX) -c $(COPTS) $(MPI_CFLAGS) mpi/mpipack.cc -o mpi/mpipack.o

mpi/mpimod.o : mpi/mpimod.cc
	$(CXX) -c $(COPTS) $(MPI_CFLAGS) mpi/mpimod.cc -o mpi/mpimod.o

pvm/pvmpack.o : pvm/pvmpack.cc
	$(CXX) -c $(COPTS) $(PVM_CFLAGS) pvm/pvmpack.cc -o pvm/pvmpack.o

pvm/pvmmod.o : pvm/pvmmod.cc
	$(CXX) -c $(COPTS) $(PVM_CFLAGS) pvm/pvmmod.cc -o pvm/pvmmod.o

missing-mpi-library:
	@ echo '  *** No MPI installation found -- skipping sim_mpi'

missing-pvm-library:
	@ echo '  *** No PVM installation found -- skipping sim_pvm'

depend:
	$(MAKEDEPEND) -I../../include -- *.cc
	$(MAKEDEPEND) -I../../include -fMakefile.in -- *.cc

clean:
	rm -f *.o std/*.o pvm/*.o
	rm -f libsim_std$(A_LIB_SUFFIX) libsim_std$(SO_LIB_SUFFIX)
	rm -f libsim_pvm$(A_LIB_SUFFIX) libsim_pvm$(SO_LIB_SUFFIX)
	rm -f libsim_mpi$(A_LIB_SUFFIX) libsim_mpi$(SO_LIB_SUFFIX)

# DO NOT DELETE THIS LINE -- make depend depends on it.
carray.o: carray.cc \
  ../../include/macros.h \
  ../../include/errmsg.h \
  ../../include/carray.h \
  ../../include/ctypes.h \
  ../../include/chead.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h
ccor.o: ccor.cc \
  ../../include/ccor.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h
cdensity.o: cdensity.cc \
  ../../include/macros.h \
  ../../include/cdensity.h \
  ../../include/ctypes.h \
  ../../include/chead.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/cstat.h
cdetect.o: cdetect.cc \
  ../../include/csimul.h \
  ../../include/cdetect.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/errmsg.h \
  ../../include/chead.h \
  ../../include/cmsgheap.h \
  ../../include/coutvect.h \
  ../../include/ccor.h \
  ../../include/cobject.h \
  ../../include/cstat.h
cenum.o: cenum.cc \
  ../../include/macros.h \
  ../../include/ctypes.h \
  ../../include/csimul.h \
  ../../include/cenum.h \
  ../../include/chead.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/errmsg.h \
  ../../include/cmsgheap.h \
  ../../include/coutvect.h \
  ../../include/ccor.h
cfsm.o: cfsm.cc \
  ../../include/macros.h \
  ../../include/cfsm.h \
  ../../include/ctypes.h \
  ../../include/chead.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h
cgate.o: cgate.cc \
  ../../include/cmessage.h \
  ../../include/cmodule.h \
  ../../include/carray.h \
  ../../include/cpar.h \
  ../../include/cenvir.h \
  ../../include/csimul.h \
  ../../include/macros.h \
  ../../include/cgate.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/ccor.h \
  ../../include/chead.h \
  ../../include/cqueue.h \
  ../../include/errmsg.h \
  ../../include/cmsgheap.h \
  ../../include/coutvect.h \
  ../../include/ctypes.h
chead.o: chead.cc \
  ../../include/macros.h \
  ../../include/chead.h \
  ../../include/ctypes.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h
chist.o: chist.cc \
  ../../include/macros.h \
  ../../include/cdetect.h \
  ../../include/chist.h \
  ../../include/ctypes.h \
  ../../include/chead.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/cstat.h \
  ../../include/cdensity.h
cksplit.o: cksplit.cc \
  ../../include/macros.h \
  ../../include/cenvir.h \
  ../../include/cksplit.h \
  ../../include/ctypes.h \
  ../../include/chead.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/cpar.h \
  ../../include/cdensity.h \
  ../../include/cstat.h
cllist.o: cllist.cc \
  ../../include/macros.h \
  ../../include/cllist.h \
  ../../include/ctypes.h \
  ../../include/chead.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h
cmessage.o: cmessage.cc \
  ../../include/macros.h \
  ../../include/cmodule.h \
  ../../include/cmessage.h \
  ../../include/ctypes.h \
  ../../include/chead.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/ccor.h \
  ../../include/carray.h \
  ../../include/cqueue.h \
  ../../include/cgate.h \
  ../../include/csimul.h \
  ../../include/errmsg.h \
  ../../include/cmsgheap.h \
  ../../include/coutvect.h \
  ../../include/cpar.h
cmodule.o: cmodule.cc \
  ../../include/cmodule.h \
  ../../include/cgate.h \
  ../../include/cmessage.h \
  ../../include/csimul.h \
  ../../include/carray.h \
  ../../include/ctypes.h \
  ../../include/cpar.h \
  ../../include/cnetmod.h \
  ../../include/cenvir.h \
  ../../include/cobject.h \
  ../../include/ccor.h \
  ../../include/chead.h \
  ../../include/cqueue.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/errmsg.h \
  ../../include/cmsgheap.h \
  ../../include/coutvect.h
cmsgheap.o: cmsgheap.cc \
  ../../include/macros.h \
  ../../include/cmessage.h \
  ../../include/cmsgheap.h \
  ../../include/ctypes.h \
  ../../include/chead.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/carray.h \
  ../../include/cpar.h \
  ../../include/csimul.h \
  ../../include/errmsg.h \
  ../../include/coutvect.h \
  ../../include/ccor.h
cnetmod.o: cnetmod.cc \
  ../../include/cpar.h \
  ../../include/cenvir.h \
  ../../include/cnetmod.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/cmodule.h \
  ../../include/ccor.h \
  ../../include/chead.h \
  ../../include/carray.h \
  ../../include/cqueue.h \
  ../../include/cgate.h \
  ../../include/csimul.h \
  ../../include/errmsg.h \
  ../../include/cmsgheap.h \
  ../../include/coutvect.h
cobject.o: cobject.cc \
  ../../include/csimul.h \
  ../../include/cenvir.h \
  ../../include/macros.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/errmsg.h \
  ../../include/chead.h \
  ../../include/cmsgheap.h \
  ../../include/coutvect.h \
  ../../include/ccor.h \
  ../../include/cpar.h \
  ../../include/ctypes.h
coutvect.o: coutvect.cc \
  ../../include/coutvect.h \
  ../../include/cmodule.h \
  ../../include/csimul.h \
  ../../include/cenvir.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/ccor.h \
  ../../include/chead.h \
  ../../include/carray.h \
  ../../include/cqueue.h \
  ../../include/cgate.h \
  ../../include/errmsg.h \
  ../../include/cmsgheap.h \
  ../../include/cpar.h
cpacket.o: cpacket.cc \
  ../../include/macros.h \
  ../../include/cpacket.h \
  ../../include/ctypes.h \
  ../../include/chead.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/cmessage.h \
  ../../include/carray.h \
  ../../include/cpar.h \
  ../../include/csimul.h \
  ../../include/errmsg.h \
  ../../include/cmsgheap.h \
  ../../include/coutvect.h \
  ../../include/ccor.h
cpar.o: cpar.cc \
  ../../include/cpar.h \
  ../../include/cstat.h \
  ../../include/macros.h \
  ../../include/errmsg.h \
  ../../include/cmodule.h \
  ../../include/csimul.h \
  ../../include/cenvir.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/ctypes.h \
  ../../include/chead.h \
  ../../include/ccor.h \
  ../../include/carray.h \
  ../../include/cqueue.h \
  ../../include/cgate.h \
  ../../include/cmsgheap.h \
  ../../include/coutvect.h
cpsquare.o: cpsquare.cc \
  ../../include/macros.h \
  ../../include/cpsquare.h \
  ../../include/ctypes.h \
  ../../include/chead.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/cdensity.h \
  ../../include/cstat.h
cqueue.o: cqueue.cc \
  ../../include/macros.h \
  ../../include/cqueue.h \
  ../../include/ctypes.h \
  ../../include/chead.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h
csimul.o: csimul.cc \
  ../../include/cmodule.h \
  ../../include/cmessage.h \
  ../../include/csimul.h \
  ../../include/cenvir.h \
  ../../include/ctypes.h \
  ../../include/cpar.h \
  ../../include/cnetmod.h \
  ../../include/cstat.h \
  ../../include/cobject.h \
  ../../include/ccor.h \
  ../../include/chead.h \
  ../../include/carray.h \
  ../../include/cqueue.h \
  ../../include/cgate.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/errmsg.h \
  ../../include/cmsgheap.h \
  ../../include/coutvect.h
cstat.o: cstat.cc \
  ../../include/cstat.h \
  ../../include/macros.h \
  ../../include/cdetect.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/ctypes.h \
  ../../include/chead.h
cstk.o: cstk.cc \
  ../../include/cstk.h \
  ../../include/errmsg.h \
  ../../include/ccor.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h
cstruct.o: cstruct.cc \
  ../../include/cstruct.h \
  ../../include/cenum.h \
  ../../include/util.h \
  ../../include/errmsg.h \
  ../../include/ctypes.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/chead.h
ctopo.o: ctopo.cc \
  ../../include/macros.h \
  ../../include/cmodule.h \
  ../../include/cgate.h \
  ../../include/cpar.h \
  ../../include/cllist.h \
  ../../include/ctopo.h \
  ../../include/ctypes.h \
  ../../include/chead.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/ccor.h \
  ../../include/carray.h \
  ../../include/cqueue.h \
  ../../include/csimul.h \
  ../../include/errmsg.h \
  ../../include/cmsgheap.h \
  ../../include/coutvect.h
ctypes.o: ctypes.cc \
  ../../include/cpar.h \
  ../../include/cmodule.h \
  ../../include/macros.h \
  ../../include/ctypes.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/ccor.h \
  ../../include/chead.h \
  ../../include/carray.h \
  ../../include/cqueue.h \
  ../../include/cgate.h \
  ../../include/csimul.h \
  ../../include/errmsg.h \
  ../../include/cmsgheap.h \
  ../../include/coutvect.h
cvarhist.o: cvarhist.cc \
  ../../include/macros.h \
  ../../include/cvarhist.h \
  ../../include/ctypes.h \
  ../../include/chead.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h \
  ../../include/chist.h \
  ../../include/cdensity.h \
  ../../include/cstat.h
cwatch.o: cwatch.cc \
  ../../include/cwatch.h \
  ../../include/cobject.h \
  ../../include/defs.h \
  ../../include/util.h
errmsg.o: errmsg.cc
util.o: util.cc \
  ../../include/util.h \
  ../../include/csimul.h \
  ../../include/macros.h \
  ../../include/cwatch.h \
  ../../include/cpacket.h \
  ../../include/defs.h \
  ../../include/errmsg.h \
  ../../include/chead.h \
  ../../include/cmsgheap.h \
  ../../include/coutvect.h \
  ../../include/ccor.h \
  ../../include/cobject.h \
  ../../include/ctypes.h \
  ../../include/cmessage.h \
  ../../include/carray.h \
  ../../include/cpar.h
