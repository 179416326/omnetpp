# Definitions to be customized by 'configure'
CC=@CC@
CC=@CC@
LD=@LD@
YACC=@YACC@
LEX=@LEX@

OMNETPP_ROOT=@OMNETPP_ROOT@
OMNETPP_SRC_DIR=@OMNETPP_SRC_DIR@
OMNETPP_BITMAP_PATH=@OMNETPP_BITMAP_PATH@

TK_INCL_PATH=@TK_INCL_PATH@
X_INCL_PATH=@X_INCL_PATH@

X_LIBS=@X_LIBS@
TK_LIBS=@TK_LIBS@
SYS_LIBS=@SYS_LIBS@

TK_LIB_PATH=@TK_LIB_PATH@
X_LIB_PATH=@X_LIB_PATH@

# Local definitions
# ebnf_tab=ebnf_tab
# lexyy=lexyy
ebnf_tab=@ebnf_tab@
lexyy=lex.yy

GNED_INCLUDES=arrow.h parsened.h tklib.h

CC_OPTS=-fwritable-strings $(TK_INCL_PATH) $(X_INCL_PATH)

OMNETPP_GNED_DIR=$(OMNETPP_SRC_DIR)/gned

OBJS = gned.o tklib.o arrow.o  $(ebnf_tab).o $(lexyy).o parsened.o disp.o nedfile.o

all : gned

gned : $(OBJS)
	$(LD) $(OBJS) $(TK_LIB_PATH) $(TK_LIBS) $(X_LIB_PATH) $(X_LIBS) $(SYS_LIBS) -o gned


gned.o : gned.cc $(INCLUDES)
	$(CXX) $(CC_OPTS) -DOMNETPP_GNED_DIR=\"$(OMNETPP_GNED_DIR)\" -DOMNETPP_BITMAP_PATH=\"$(OMNETPP_BITMAP_PATH)\" gned.cc

tklib.o : tklib.cc $(INCLUDES)
	$(CXX) $(CC_OPTS) tklib.cc

arrow.o: arrow.cc arrow.h
	$(CXX) $(CC_OPTS) arrow.cc

parsened.o: parsened.cc parsened.h disp.h
	$(CXX) $(CC_OPTS) parsened.cc

nedfile.o: nedfile.cc nedfile.h
	$(CXX) $(CC_OPTS) nedfile.cc

disp.o: disp.h disp.cc
	$(CXX) $(CC_OPTS) disp.cc

$(lexyy).o: parsened.h $(lexyy).c
	$(CXX) $(lexyy).c

$(ebnf_tab).o: parsened.h $(ebnf_tab).h $(ebnf_tab).c
	$(CXX) $(ebnf_tab).c

$(ebnf_tab).h: ebnf.y
	$(YACC) -b ebnf -d ebnf.y

$(ebnf_tab).c: ebnf.y
	$(YACC) -b ebnf -d ebnf.y

$(lexyy).c: ebnf.lex
	$(LEX) ebnf.lex

