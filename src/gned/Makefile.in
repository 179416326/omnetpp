#
# Definitions to be customized by 'configure'
#
CXX=@CXX@
LD=@LD@
YACC=@YACC@
LEX=@LEX@

CFLAGS=@CFLAGS@

OMNETPP_ROOT=@OMNETPP_ROOT@
OMNETPP_SRC_DIR=@OMNETPP_SRC_DIR@
OMNETPP_BITMAP_PATH=@OMNETPP_BITMAP_PATH@

TK_INCL_PATH=@TK_INCL_PATH@
TK_LIBS=@TK_LIBS@
SYS_LIBS=@SYS_LIBS@

#
# Local definitions
#
COPTS=-fwritable-strings $(CFLAGS) $(TK_INCL_PATH)

OMNETPP_GNED_DIR=$(OMNETPP_SRC_DIR)/gned

OBJS = gned.o tklib.o arrow.o ebnf.tab.o lex.yy.o parsened.o disp.o nedfile.o

#
# Targets
#
default: @GNED_IF_POSSIBLE@

gned : $(OBJS)
	$(LD) $(OBJS) $(TK_LIBS) $(SYS_LIBS) -o gned

gned.o : gned.cc
	$(CXX) -c $(COPTS) -DOMNETPP_GNED_DIR=\"$(OMNETPP_GNED_DIR)\" -DOMNETPP_BITMAP_PATH=\"$(OMNETPP_BITMAP_PATH)\" gned.cc

tklib.o : tklib.cc
	$(CXX) -c $(COPTS) tklib.cc

arrow.o: arrow.cc
	$(CXX) -c $(COPTS) arrow.cc

parsened.o: parsened.cc
	$(CXX) -c $(COPTS) parsened.cc

nedfile.o: nedfile.cc
	$(CXX) -c $(COPTS) nedfile.cc

disp.o: disp.cc
	$(CXX) -c $(COPTS) disp.cc

lex.yy.o: lex.yy.c
	$(CXX) -c $(COPTS) lex.yy.c

ebnf.tab.o: ebnf.tab.c
	$(CXX) -c $(COPTS) ebnf.tab.c

ebnf.tab.h: ebnf.y
	$(YACC) -b ebnf -d ebnf.y

ebnf.tab.c: ebnf.y
	$(YACC) -b ebnf -d ebnf.y

lex.yy.c: ebnf.lex
	$(LEX) ebnf.lex

missing-library:
	echo '*** No Tk installation found -- skipping GNED'

depend:
	makedepend -Y -I. -- *.c *.cc
	makedepend -Y -I. -fmakefile.in -- *.c *.cc

clean:
	rm -f *.o lex.yy.c ebnf.tab.c ebnf.tab.h gned


# DO NOT DELETE THIS LINE -- make depend depends on it.


