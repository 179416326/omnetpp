#!/bin/sh
#
# all2unix: converts text files from DOS to UNIX format (chop CRs)
#

# variable to be set by 'configur':
OMNETPP_ROOT="/home/andras/omnetpp"

cd $OMNETPP_ROOT

echo Converting text files in `pwd` to Unix.
find . | while true
do
    read file
    if [ "X$file" = "X" ]; then
       break
    fi

    if [ -f "$file" ]; then
       chmod 644 $file
       if (file $file | grep text) ; then
          cp $file $file.b
          sed 's/[[:cntrl:]]$//g' $file.b > $file
          rm $file.b
       else
          echo "*** $file is non-text"
       fi
    else
       echo "---  $file is not a regular file"
    fi
done

echo ""
echo Making scripts in utils/ executable...
(cd src/utils; chmod 755 all2unix dos2unix makeall makemake jar_mkmk makedist splitvec configur convert mklinks prephtml)
(cd bitmaps; chmod 755 showpics)
(cd src/plove; chmod 755 plove)
(cd src/nedc; chmod 755 jar)

echo Done


