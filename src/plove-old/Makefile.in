#
# Definitions to be customized by 'configure'
#
CXX=@CXX@
CC=@CC@
YACC=@YACC@
LEX=@LEX@

CFLAGS=@CFLAGS@
LDFLAGS=@LDFLAGS@
EXE_SUFFIX=@EXE_SUFFIX@

OMNETPP_BIN_DIR=@OMNETPP_BIN_DIR@

TK_CFLAGS=@TK_CFLAGS@
TK_LIBS=@TK_LIBS@
SYS_LIBS=@SYS_LIBS@

# The following is either 'plove-exe' (embedded Tcl code) or 'plove-sh' (no embedding)
PLOVE_VARIANT=@PLOVE_VARIANT@

#
# Local definitions
#
COPTS=$(CFLAGS) $(TK_CFLAGS)
OBJS=plove.o

all: plove

plove: $(PLOVE_VARIANT)
	../utils/install-prog plove $(OMNETPP_BIN_DIR)

plove-sh: plove.sh
	cp plove.sh plove

plove-exe: $(OBJS)
	$(CC) $(LDFLAGS) $(OBJS) $(TK_LIBS) $(SYS_LIBS) -o plove

plove.o: plove.cc tclcode.cc
	$(CXX) -c $(COPTS) plove.cc

tclcode.cc: *.tcl
	../utils/tcl2c tclcode.cc *.tcl

missing-library:
	@ echo '*** No Tk installation found -- skipping Plove'

depend:
	makedepend -Y -I. -- *.c *.cc
	makedepend -Y -I. -fMakefile.in -- *.c *.cc

clean:
	rm -f tclcode.cc *.o plove$(EXE_SUFFIX) plove

# DO NOT DELETE THIS LINE -- make depend depends on it.
