<?xml version="1.0"?>
<!DOCTYPE chapter SYSTEM "custom-docbook.dtd">
<chapter id="_writing_wizards">
<title>Writing Wizards</title>
<section id="_motivation">
<title>Motivation</title>
<simpara>The OMNeT++ IDE offers several wizards via the File|New menu: New OMNeT++
Project, New Simple Module, New Compound Module, New Ini File, and so on.
By default these wizards already offer useful functionality to the user,
but using the information in this chapter, it is possible to add to them
new UI elements and content templates that are specific to simulation models.
For example, one can create a New INET Ad-Hoc Network wizard, a New MiXiM
Simulation Wizard, an Import INET Network From CSV File wizard, a
New MiXiM Radio Model wizard, and so on.</simpara>
<simpara>These wizards can be prepared with low effort and without any Java or C++
programming, and can be distributed with the corresponding model framework
(i.e. INET or MiXiM). When end users import the model framework project
into the IDE, the wizards get automatically contributed to the corresponding
wizard dialogs; the end user does not need to install them or otherwise do
anything to deploy the wizards.</simpara>
<simpara>When you are writing a model framework which will be available for the
general public, wizards are a great way to teach your users about your
simulation model. While documentation and example simulations are somewhat
passive ways of educating your users, wizards are more interactive and
encourage users to experiment with the model and explore its capabilities.
The right set of capable wizards can give a jump start to users, and
emphasizes learning by doing.</simpara>
</section>
<section id="_overview">
<title>Overview</title>
<simpara>Custom wizards are read from the <literal>templates/</literal> folder of OMNeT++ projects.
Wizards are implemented by mixing a templating engine (for generating
the output files) and a GUI description language (for custom wizard pages to
gather user input for the file generation). Because of the use of a
templating engine, we&#8217;ll also refer to custom wizards as "content templates".</simpara>
<simpara>In the templates/ folder, every subfolder that contains a <literal>template.properties</literal>
file is treated as a content template. (Other folders are ignored.) Every
content template folder may contain several types of files:</simpara>
<itemizedlist>
<listitem>
<simpara>
The <literal>template.properties</literal> file contains general information about the wizard.
  Defines the initial value for the template variables and specifies the
  custom wizard pages to be invoked when the wizard is run.
</simpara>
</listitem>
<listitem>
<simpara>
<literal>*.ftl</literal> files are template files that will be copied (without the <literal>.ftl</literal> extension)
  into the target folder after template variable substitution.
</simpara>
</listitem>
<listitem>
<simpara>
<literal>*.xswt</literal> files describe custom wizard pages to gather user input.
</simpara>
</listitem>
<listitem>
<simpara>
More rarely used files are <literal>*.fti</literal> (template include) files included by <literal>*.ftl</literal>
  files. This can be used to factor out common parts from the template files.
</simpara>
</listitem>
<listitem>
<simpara>
<literal>*.jar</literal> files that can be used to extend the wizard&#8217;s functionality
  with dynamically loaded Java code.
</simpara>
</listitem>
<listitem>
<simpara>
All other files are regarded as files that have to be copied into the
  target folder verbatim when the wizard runs. The wizard folder may contain
  subdirectories which may also contain files of the above type (except
  template.properties of course).
</simpara>
</listitem>
</itemizedlist>
<simpara>The IDE offers several OMNeT<literal>-related wizard dialogs: New OMNeT</literal> Project,
New NED File, New Simple Module, and so on. Every content template can
contribute to one or more of those wizard dialogs.</simpara>
<section id="_configuring_the_wizard">
<title>Configuring the Wizard</title>
<simpara>The first step when creating a wizard is to create a new folder
under the <literal>templates</literal> directory of the project. A file named <literal>template.properties</literal>
must be present in the newly created directory. The file is used to configure
the wizard.</simpara>
<literallayout class="monospaced">templateName = New Test Wizard
templateDescription = Generate an exampmle
templateCategory = Test Wizards
supportedWizardTypes = simulation, network</literallayout>
<simpara>Specify at least the name, type and category for your wizard. Category is used to
specify how the wizards will be visually grouped. Wizard type specifies, in which
New &#8230; Wizard  your new wizard will appear. You can specify one or more of the
following types: <literal>project, simulation, nedfile, inifile, msgfile, wizard,
simplemodue, compoundmodule, network, import, export</literal></simpara>
<simpara>You can decide now what data you would like to gather from the user. Define
template variables and their values as key-value pairs:</simpara>
<literallayout class="monospaced">nodeName = Dummy
networkSize = 6</literallayout>
<simpara>The wizard should have a custom page, where the user can specify the value of the above variables.</simpara>
<literallayout class="monospaced">page.1.file = parameters.xswt
page.1.title = Network parameters</literallayout>
<simpara>We will use the file <literal>parameters.xswt</literal> to define the layout and the content of the new wizard page.</simpara>
<note><simpara>There are numerous other configuration keys that can be used in <literal>template.properties</literal>. See the
"Configuration Keys" section for an exhaustive list of options.</simpara></note>
</section>
<section id="_creating_a_new_wizard_page">
<title>Creating a new Wizard Page</title>
<simpara>Files with <literal>.xswt</literal> extension (Wizard Page definitions) are used to define the UI and
add new wizard pages to gather user input for the template generation. In the previous
section we have specified that the file called <literal>parameters.xswt</literal> will contain the new
wizard page definition. We will add a <emphasis>spinner</emphasis> control to specify the size of our network
and a <emphasis>text</emphasis> control to specify the node type:</simpara>
<literallayout class="monospaced">&lt;xswt xmlns:x="http://sweet_swt.sf.net/xswt"&gt;
        &lt;import xmlns="http://sweet_swt.sf.net/xswt"&gt;
          &lt;!-- Import all widgets and utility classes  --&gt;
          &lt;package name="java.lang"/&gt;
          &lt;package name="org.eclipse.swt.widgets" /&gt;
          &lt;package name="org.eclipse.swt.graphics" /&gt;
          &lt;package name="org.eclipse.swt.layout" /&gt;
          &lt;package name="org.eclipse.swt.custom" /&gt;
          &lt;package name="org.omnetpp.common.wizard.support" /&gt;
          &lt;package name="org.omnetpp.ned.editor.wizards.support" /&gt;
          &lt;package name="org.omnetpp.cdt.wizard.support" /&gt;
        &lt;/import&gt;
        &lt;layout x:class="GridLayout" numColumns="2"/&gt;
        &lt;x:children&gt;
          &lt;label text="Number nodes in the network:"/&gt;
          &lt;spinner x:id="networkSize" minimum="2" x:style="BORDER"/&gt;
          &lt;label text="Type of Nodes:"/&gt;
          &lt;text x:id="nodeName" x:style="BORDER"/&gt;
        &lt;/x:children&gt;
&lt;/xswt&gt;</literallayout>
<simpara>The above page will have two columns. The first column contains a label,
while the second contains an editable control.
Please note the <literal>x:id="varName"</literal> attributes in the spinner and text control
definitions. We can bind a template variable to a control using the <literal>id</literal> attribute.
When the user finishes with the wizard page, the content of the controls will be
automatically copied to the specified template variables.</simpara>
</section>
<section id="_creating_templated_files">
<title>Creating Templated Files</title>
<simpara>When the template is used, the contents of the template folder (and subfolders)
will be copied over into the new project preserving the directory structure,
with the exception of <literal>template.properties</literal> and other known special-purpose files.
(It is also possible to specify other files and folders to ignore during copying.)</simpara>
<simpara>When the wizard is being used, a pool of variables is kept by the wizard dialog.
These variables are initialized from the <literal>key = value</literal> lines in the
<literal>template.properties</literal> files; they can get displayed and/or edited
on custom wizard pages; and eventually they get substituted into <literal>*.ftl</literal> files
(using the ${varname} syntax).</simpara>
<simpara>Some variables have special meaning and are interpreted by the wizard dialog
(e.g. the <literal>nedSrcFolders</literal> variable determines which folders get denoted as
NED Source Folders by the New OMNeT++ Project wizard). Variables can be used
to generate output file names, can be used as input file names, and can serve
as input and working variables for arbitrarily complex algorithms programmed
in the template (<literal>*.ftl</literal>) files.</simpara>
<simpara>Create a file named <literal>untitled.ned.flt</literal>.</simpara>
<literallayout class="monospaced">&lt;@setoutput path=targetFileName?default("")/&gt;
${bannerComment}</literallayout>
<literallayout class="monospaced">&lt;#if nedPackageName!=""&gt;package ${nedPackageName};&lt;/#if&gt;</literallayout>
<literallayout class="monospaced">network ${targetTypeName}
{
        node[${networkSize}] : ${nodeName}
}</literallayout>
<simpara>The file name for the output will be the value of the <literal>targetFileName</literal> variable.
The rest of template variables will be substituted into the template.</simpara>
<simpara>Specific wizard dialogs will also define extra variables for use in the
templates, e.g. the wizard types that create a single file will put the
<literal>newFileName</literal> variable into the context. To see all defined variables,
check the Appendix.</simpara>
<tip><simpara>The "New Wizard" wizard in the IDE provides you with more than a handful of
     working examples, useful utilities for writing wizards, sample code for
     accessing various features, and so on. The aim of these wizards is to get you
     productive in the shortest time possible.</simpara></tip>
</section>
<section id="_wizard_types">
<title>Wizard Types</title>
<simpara>The wizard will set the <literal>wizardType</literal> template variable when it executes,
so template code can check under which wizard type it runs (using <literal>&lt;#if&gt;..&lt;/#if&gt;</literal>), and
act accordingly. This feature allows the creation of templates that
can be used for multiple wizard types.</simpara>
<simpara>Create a file called <literal>omnetpp.ini.ftl</literal> and fill with:</simpara>
<literallayout class="monospaced">&lt;#if wizardType=="simulation"&gt;
network = ${targetTypeName}
&lt;/#if&gt;</literallayout>
<simpara>We need the INI file only if we are creating a simulation. If the
current type is not <emphasis>simulation</emphasis>, an empty file will be generated
and it will not be copied to the destination folder.</simpara>
<simpara>There are several types of wizards you can create. Each one has a different
goal:</simpara>
<section id="_new_project_wizards">
<title>New Project Wizards</title>
<simpara>Project wizards can create&#8201;&#8212;&#8201;as their name suggest&#8201;&#8212;&#8201;new projects. All necessary files
required by the new project can be included in the template. It is possible to adjust
project properties to customize the new project. You can enable C++ code support, set
source and NED folders. The files in the template folder will be directly copied to the
new project folder.</simpara>
</section>
<section id="_new_simulation_wizards">
<title>New Simulation Wizards</title>
<simpara>A new simulation is basically a network definition plus an INI file
describing the initial configurations and parameter values. These
files are typically created in a separate directory that is selected
in the wizard as the <emphasis>simulation folder</emphasis>.</simpara>
</section>
<section id="_new_ini_msg_or_ned_file_wizards">
<title>New INI,MSG or NED File Wizards</title>
<simpara>New &#8230; File Wizards generate only a single file. The filename can be accessed in the</simpara>
</section>
<section id="_export_import_wizards">
<title>Export / Import Wizards</title>
<simpara>Export and import wizards work similarly like the other wizards, but the input
and output files must be specified on custom wizard pages.</simpara>
</section>
</section>
</section>
<section id="_configuration_keys">
<title>Configuration Keys</title>
<simpara>The <literal>template.properties</literal> file is a standard Java property file (<literal>key = value</literal> syntax).
That file can be used to supply a template name, a template description,
and various other options.</simpara>
<simpara>Recognized property file keys:</simpara>
<variablelist>
<varlistentry>
<term>
templateName
</term>
<listitem>
<simpara>
                                The template&#8217;s display name; defaults to the folder name.
                This is the name that appears in the wizard&#8217;s template selection
                page.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
templateDescription
</term>
<listitem>
<simpara>
                Description of the template. This may appear as a tooltip
                or in a description pane in the wizard.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
templateCategory
</term>
<listitem>
<simpara>
                Template category is used for organizing the templates into a
                tree in the wizard&#8217;s template selection page. Defaults to the
                name of the project that provides the template.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
templateImage
</term>
<listitem>
<simpara>
                Name of the icon that appears with the name in the wizard&#8217;s
                template selection page.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
supportedWizardTypes
</term>
<listitem>
<simpara>
                Comma-separated or JSON-syntax list of wizard types (e.g.
                "nedfile", "simplemodule", "project", "inifile") that
                this template supports. More about this later.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
ignoreResources
</term>
<listitem>
<simpara>
                Comma-separated or JSON-syntax list of non-template files or
                folders; those files won&#8217;t get copied over to the new project.
                Wildcards are accepted. The template.properties file and
                custom wizard page files automatically count as nontemplates,
                so they don&#8217;t have to be listed.
</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>The "New OMNeT++ Project" wizard also recognizes the following options. These
options can be overridden from custom wizard pages.</simpara>
<variablelist>
<varlistentry>
<term>
addProjectReference
</term>
<listitem>
<simpara>
                True or false; defaults to true. If true, the template&#8217;s project
                will be added to the referenced projects list of the new project.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
sourceFolders
</term>
<listitem>
<simpara>
                Comma-separated or JSON-syntax list of C++ source folders
                to be created and configured. By default, none.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
nedSourceFolders
</term>
<listitem>
<simpara>
                Comma-separated or JSON-syntax list of NED source folders
                to be created and configured. By default, none.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
makemakeOptions
</term>
<listitem>
<simpara>
                Comma-separated list of items in the syntax "folder:options",
                or a JSON-syntax map of strings; it sets opp_makemake options
                for the given folders. There is no default.
</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>There are additional options for adding custom pages into the wizard, as described
in the next section.</simpara>
</section>
<section id="_template_processing">
<title>Template Processing</title>
<simpara>Template processing uses the FreeMarker library (<ulink url="http://freemarker.org">http://freemarker.org</ulink>), and
all template syntax supported by FreeMarker can be used. Especially, variable
references of the syntax ${varName} will be replaced with the variable value.</simpara>
<simpara>The FreeMarker language also offers constructs that make it a full programming
language: variable assignments, conditionals, loops, switch statement,
functions, macros, expression evaluation, built-in operators, etc, as well
as access to fields and methods of classes defined in Java. This means that
any algorithm can be expressed in the FreeMarker language, and if that would
not be enough, one can also pull in existing or custom-written Java libraries.</simpara>
<tip><simpara>Documentation for the FreeMarker template language can be found at:
     <ulink url="http://freemarker.org/docs/index.html">http://freemarker.org/docs/index.html</ulink></simpara></tip>
<simpara>Several variables are predefined, such as <literal>templateName, targetFolder, date,
author</literal>; others like <literal>targetFileName, targetTypeName, simulationFolderName,
nedPackageName</literal>, etc. are defined only for certain wizard dialogs.
A full list of variables is provided in the Appendix.</simpara>
<section id="_generating_multiple_files">
<title>Generating multiple files</title>
<simpara>By default templates are processed and copied with the same name (chopping the .ftl
extension), but it is possible to redirect the output of the template to a different
file using the <literal>&lt;@setoutput path=.../&gt;</literal> macro. The filename can contain slashes too, i.e.
one can write files in a different folder. If the folder does not exist, it will
be created.</simpara>
<simpara>If filename is empty, the directive restores output to the original file name (the template&#8217;s name).
This also works if a folder name is given and only the file name is missing
(<literal>&lt;@setoutput path="src/"&gt;</literal>): then it will write the file with the original name
but into the specified folder.</simpara>
<note><simpara>If there are multiple setoutput&#8217;s with the same file name within a template,
the content will be concatenated. Concatenation only works within one template;
if you have multiple templates writing into the same file, they will overwrite
each other&#8217;s content, and it is undefined which one will win.</simpara></note>
</section>
<section id="_conditional_file_creation">
<title>Conditional file creation</title>
<simpara>Empty and blank files (ie. those containing only white space) will not be created,
i.e. processing will skip writing it without any question, warning or error.
This allows you to easily create conditional files. This also means that you
cannot create empty files this way. However, this "limitation" is easy to overcome
as most file formats (ned, c++, ini, xml, etc) have a comment syntax, so you
can just write a file that contains only a comment ("// file intentionally left blank").
Alternatively, you can create an empty file using the FileUtils Java utility class
(<literal>&lt;@do FileUtils.createFile("empty.txt", "")!/&gt;</literal>).</simpara>
<note><simpara>Although blank files are not created, the template engine will not delete an
      existing file that happens to be already there with the same name.</simpara></note>
<tip><simpara>A typical usage: <literal>&lt;@setoutput path=fileName?default("")/&gt;</literal>, which means that if
     the fileName variable undefined (absent), use "" as file name, i.e. save to
     the original file name.</simpara></tip>
</section>
</section>
<section id="_custom_wizard_pages">
<title>Custom Wizard Pages</title>
<simpara>The following properties can be used to define custom pages in the wizard. <literal>&lt;i&gt;</literal> is
an integer page ID (starting with 1); their ordering defines the order of wizard
pages.</simpara>
<variablelist>
<varlistentry>
<term>
page.&lt;i&gt;.file
</term>
<listitem>
<simpara>
                The name of the XSWT file that describes the wizard page layout.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
page.&lt;i&gt;.class
</term>
<listitem>
<simpara>
                In addition to XSWT files, custom Java pages may also be defined
                in Java code. This can be useful when the wizard page would be
                too complex to describe with XSWT, would need to have significant
                active behavior, or simply the wizard page code already exists
                in Java form. See below for further discussion about custom pages.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
page.&lt;i&gt;.title
</term>
<listitem>
<simpara>
                Title of the wizard page, displayed in the page&#8217;s title area.
                Defaults to the template name.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
page.&lt;i&gt;.description
</term>
<listitem>
<simpara>
                Description of the wizard page, shown in the dialog&#8217;s title area
                below the title. Defaults to text in the format "Page 1 of 3".
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
page.&lt;i&gt;.condition
</term>
<listitem>
<simpara>
                A condition for showing the page. If it evaluates to false, the
                page will be skipped when it would normally come in the page
                sequence of the wizard. This makes it possible not only to skip
                pages, but also to show different pages based on some choice
                or choices the user made earlier in the wizard (decision tree).
                The condition will be evaluated by the template engine, so any
                valid FreeMarker expression that can produce true or "true" as
                a result will do. The expression must be supplied without the
                <literal>${</literal> and <literal>}</literal> marks: the string you enter will be substituted into
                "<literal>${( &lt;condition&gt; )?string}</literal>" string (will replace "<literal>&lt;condition&gt;</literal>"),
                and evaluate as such. An example will be provided later.
</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>All property file entries are available as template variables too. Also, most
property values may refer to other property values or template variables, using
the ${name} syntax.</simpara>
<note><simpara>Custom wizard pages are defined in XSWT (<ulink url="http://xswt.sourceforge.net">http://xswt.sourceforge.net</ulink>,
      <ulink url="http://www.coconut-palm-software.com/the_new_visual_editor/doku.php?id=xswt:home">http://www.coconut-palm-software.com/the_new_visual_editor/doku.php?id=xswt:home</ulink>).</simpara></note>
<note><simpara>Currently we use XSWT 1.1.2. Newer XSWT integration builds from
      <ulink url="http://www.coconut-palm-software.com/~xswt/integration/plugins/">http://www.coconut-palm-software.com/~xswt/integration/plugins/</ulink>
      did not work out well.</simpara></note>
</section>
<section id="_conditional_custom_wizard_pages">
<title>Conditional Custom Wizard Pages</title>
<simpara>Now that templating and XSWT were covered, we can revisit how one can use page
conditions. Consider the following practical example:</simpara>
<simpara>Suppose a wizard for wireless networks. On the first page of the wizard there
is a "[] configure routing" checkbox with the ID "wantRouting". If this
checkbox gets selected, you want to display a second page where the user can
select a routing protocol, then further configuration pages depending on
the particular routing protocol the user chose. To achieve this, you would
add the following lines to template.properties:</simpara>
<literallayout class="monospaced"># page with the "wantRouting" checkbox
page.1.title = General
# page with the "protocol" combobox
page.2.title = Choose Routing Protocol
page.3.title = AODV Options
page.4.title = DSDV Options</literallayout>
<literallayout class="monospaced">page.2.condition = wantRouting
page.3.condition = wantRouting &amp;&amp; protocol=="AODV"
page.4.condition = wantRouting &amp;&amp; protocol=="DSDV"</literallayout>
<simpara>You get the idea. This allows the creation of conditional pages.</simpara>
<section id="_standard_swt_widgets">
<title>Standard SWT widgets</title>
<tip><simpara>The SWT controls are documented on the Eclipse web site. See:
<ulink url="http://help.eclipse.org/galileo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/widgets/package-summary.html">http://help.eclipse.org/galileo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/widgets/package-summary.html</ulink></simpara></tip>
<simpara>It is possible to bind template variables to a specific control by using the <literal>x:id</literal>
attribute.
  &lt;text x:id="templateVariableName" /&gt;</simpara>
<simpara>This is the way how template variables are bound to the controls (R=read, W=write):</simpara>
<variablelist>
<varlistentry>
<term>
Button
</term>
<listitem>
<simpara>
This SWT class represents buttons, checkboxes and radio
                buttons, depending on its style attribute (<literal>SWT.PUSH,
                SWT.CHECK, SWT.RADIO</literal>).
</simpara>
<itemizedlist>
<listitem>
<simpara>
W: the string "true" selects the checkbox/radiobutton,
                   everything else clears it.
</simpara>
</listitem>
<listitem>
<simpara>
R: returns a Boolean.
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>
Combo, CCombo
</term>
<listitem>
<simpara>
Represent a combo box and a custom combo box. It can be
                made read-only (with the <literal>SWT.READ_ONLY</literal> style); a read-only
                combo allows list selection but no manual editing.
                The list items can be specified from XSWT. Variables only
                work with the textedit part (cannot add/remove list items).
</simpara>
<itemizedlist>
<listitem>
<simpara>
W: the string value gets written into the combo. If the combo
                   is read-only and contains no such item, nothing happens.
</simpara>
</listitem>
<listitem>
<simpara>
R: returns the currently selected item as string.
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>
DateTime
</term>
<listitem>
<simpara>
A widget for editing date/time.
</simpara>
<itemizedlist>
<listitem>
<simpara>
W: accepts a string in the following format: "yyyy-mm-dd hh:mm:ss".
                   If the string is not in the right format, an error occurs.
</simpara>
</listitem>
<listitem>
<simpara>
R: returns a string in the same format, "yyyy-mm-dd hh:mm:ss".
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>
Label
</term>
<listitem>
<simpara>
Label widget (not interactive).
</simpara>
<itemizedlist>
<listitem>
<simpara>
W: sets the label to the string
</simpara>
</listitem>
<listitem>
<simpara>
R: returns the label
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>
List
</term>
<listitem>
<simpara>
A listbox widget that allows selection of one or more items,
                depending on the style attribute (<literal>SWT.SINGLE</literal> or <literal>SWT.MULTI</literal>).
                List items can be specified from XSWT. Template variables only
                work with the selection (cannot add/remove list items).
</simpara>
<itemizedlist>
<listitem>
<simpara>
W: accepts a string with comma-separated items, and selects the
                   corresponding item(s) in the listbox. Items that are not
                   among the listbox items are ignored.
</simpara>
</listitem>
<listitem>
<simpara>
R: Returns a string array object (String[]) that can be
                   iterated over in the template.
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>
Scale
</term>
<listitem>
<simpara>
A graphical widget for selecting a numeric value.
</simpara>
<itemizedlist>
<listitem>
<simpara>
W: accepts strings with an integer value. Non-numeric strings
                   will cause an error (a message dialog will be displayed).
</simpara>
</listitem>
<listitem>
<simpara>
R: returns an Integer which can be used in arithmetic
                   expressions in the template.
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>
Slider
</term>
<listitem>
<simpara>
A scrollbar-like widget for selecting a positive numeric value.
                Handled in a similar way as Scale.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
Spinner
</term>
<listitem>
<simpara>
Similar to a textedit, but contains little up and down arrows,
                and can be used to input an integer number.
                Handled in a similar way as Scale.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
StyledText
</term>
<listitem>
<simpara>
A textedit widget which allows displaying and editing of
                styled text. Handled similarly to Text.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
Text
</term>
<listitem>
<simpara>
A textedit widget. It can be single-line or multi-line,
                depending on the style attribute (<literal>SWT.SINGLE, SWT.MULTI</literal>).
</simpara>
<itemizedlist>
<listitem>
<simpara>
W: accepts a (potentially multi-line) string.
</simpara>
</listitem>
<listitem>
<simpara>
R: returns the edited text as a string.
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_custom_widgets">
<title>Custom widgets</title>
<variablelist>
<varlistentry>
<term>
HttpLink
</term>
<listitem>
<simpara>
A control containing a text and a hyperlink between <literal>&lt;a&gt;&lt;/a&gt;</literal> tags. An URL can
                be specified to be opened in an external browser.
</simpara>
<itemizedlist>
<listitem>
<simpara>
W: accepts a string with the target URL.
</simpara>
</listitem>
<listitem>
<simpara>
R: returns the target URL as string.
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: text : the textual content of the control <literal>&lt;a&gt;&lt;/a&gt;</literal> denotes the link inside.
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: URL : the target URL where the control points to
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>
InfoLink
</term>
<listitem>
<simpara>
A control for which displays a text with embedded link(s), and clicking
                on a link will display a hover text in a window. The hover text can be given
                the with setHoverText method (i.e. the hoverText XSWT attribute), or bound
                to a template variable (using the x:id XSWT attribute).
</simpara>
<itemizedlist>
<listitem>
<simpara>
W: accepts a string with the hover text for the control.
</simpara>
</listitem>
<listitem>
<simpara>
R: returns the hover text as string.
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: text : the content of the control
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: hoverText : the html formatted text displayed in the hover control
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: hoverMinimumWidth : the minimal width for the hover control
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: hoverMinimumHeight : the minimal height for the hover control
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: hoverPreferredWidth : the preferred width for the hover control
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: hoverPreferredHeight : the preferred height for the hover control
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>
FileLink
</term>
<listitem>
<simpara>
A control for displaying the name of a resource as a link. When clicked, it shows
                the resource (opens Project Explorer and focuses it to the resource).
</simpara>
<itemizedlist>
<listitem>
<simpara>
W: accepts a string with the workspace path of the resource to be shown.
</simpara>
</listitem>
<listitem>
<simpara>
R: returns the full workspace path of the resource.
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: resourcePath : the full workspace path of the file
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>
FileChooser
</term>
<listitem>
<simpara>
A control for selecting a file from the workspace. Implemented as a Composite with
                a single-line Text and a Browse button.
</simpara>
<itemizedlist>
<listitem>
<simpara>
W: accepts a string with the workspace file name.
</simpara>
</listitem>
<listitem>
<simpara>
R: returns the name of the selected file as a string from the workspace.
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: fileName : the full workspace path of the selected file.
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>
ExternalFileChooser
</term>
<listitem>
<simpara>
                A control for selecting a file from the filesystem. Implemented as a Composite with
                a single-line Text and a Browse button.
</simpara>
<itemizedlist>
<listitem>
<simpara>
W: accepts a string with the full file name.
</simpara>
</listitem>
<listitem>
<simpara>
R: returns the name of the selected file as a string from the filesystem.
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: fileName : the full filesystem path of the selected file.
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>
GateChooser
</term>
<listitem>
<simpara>
A control for selecting a gate of a NED module type. If the module
                exists, it lets the user select one of its gates from a combo;
                if it doesn&#8217;t, it lets the user enter a gate name.
</simpara>
<itemizedlist>
<listitem>
<simpara>
W: accepts strings with a gate name.
</simpara>
</listitem>
<listitem>
<simpara>
R: returns the name of the selected gate as a string.
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: gateName : the name of the selected gate
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: nedTypeName : the NED type whose gates should be enumerated.
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: gateFilter : type filter for the enumerated gates. Expects a
                  binary OR (|) of the following values: <literal>GateChooser.INPUT,
                  GateChooser.OUTPUT, GateChooser.INOUT, GateChooser.VECTOR,
                  GateChooser.SCALAR</literal>.
</simpara>
<literallayout class="monospaced">&lt;gateChooser x:id="gateName" nedTypeName="${nodeType}"
     gateFilter="GateChooser.INOUT|GateChooser.VECTOR"/&gt;</literallayout>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>
NedTypeChooser
</term>
<listitem>
<simpara>
                                A control for selecting a NED module type. An existing type name can be selected
                                or a new one can be entered.
</simpara>
<itemizedlist>
<listitem>
<simpara>
W: accepts strings with a ned type name.
</simpara>
</listitem>
<listitem>
<simpara>
R: returns the name of the selected ned type as a string.
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: nedName : the NED module type as a string
</simpara>
</listitem>
<listitem>
<simpara>
ATTR: acceptedTypes : filter for the enumeration of types. Expects a
                  binary OR (|) of the following values: <literal>NedTypeChooser.MODULE,
                NedTypeChooser.SIMPLE_MODULE, NedTypeChooser.COMPOUND_MODULE,
                NedTypeChooser.MODULEINTERFACE, NedTypeChooser.CHANNEL,
                NedTypeChooser.CHANNELINTERFACE, NedTypeChooser.NETWORK</literal>.
</simpara>
<literallayout class="monospaced">&lt;nedTypeChooser x:id="channelType"
     acceptedTypes="NedTypeChooser.CHANNEL"/&gt;</literallayout>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
</variablelist>
<note><simpara>Table and tree widgets are currently not supported in a useful way, the main
reason being that SWT Tables and Trees are not editable by default.</simpara></note>
<simpara>Some non-interactive widgets which cannot be connected to template variables
but are useful in forms as structuring elements:
Composite:: Used to group two or more controls into a single one.</simpara>
<literallayout class="monospaced">&lt;composite&gt;
  &lt;layoutData x:class="GridData" horizontalSpan="2"/&gt;
  &lt;layout x:class="GridLayout"/&gt;
  &lt;x:children&gt;
    &lt;button x:id="dynamic" text="Dynamic" x:style="RADIO"/&gt;
    &lt;button x:id="static" text="Static" x:style="RADIO"/&gt;
  &lt;/x:children&gt;
&lt;/composite&gt;</literallayout>
<variablelist>
<varlistentry>
<term>
Group
</term>
<listitem>
<simpara>
Used to group the controls with a visual heading.
</simpara>
<literallayout class="monospaced">&lt;group text="Heading text"&gt;
  &lt;x:children&gt;
     &lt;label text="Control 1"/&gt;
     &lt;label text="Control 2"/&gt;
  &lt;/x:children&gt;
&lt;/group&gt;</literallayout>
</listitem>
</varlistentry>
<varlistentry>
<term>
TabFolder/TabItem
</term>
<listitem>
<simpara>
Can be used to group the controls into separate pages.
</simpara>
<literallayout class="monospaced">&lt;tabFolder&gt;
  &lt;x:children&gt;
    &lt;composite x:id="page1"&gt;&lt;/composite&gt;
    &lt;composite x:id="page2"&gt;&lt;/composite&gt;
    &lt;tabItem text="Tab 1" control="page1"/&gt;
    &lt;tabItem text="Tab 2" control="page2"/&gt;
  &lt;/x:children&gt;
&lt;/tabFolder&gt;</literallayout>
</listitem>
</varlistentry>
</variablelist>
</section>
</section>
<section id="_binding_of_template_variables_to_widgets">
<title>Binding of Template Variables to Widgets</title>
<simpara>XSWT allows one to tag widgets with id attributes. Widget IDs will become the
names of template variables, with the values being the content of widgets.
For example, text widgets (org.eclipse.swt.widgets.Text) provide a string value
(Java type "String"), while checkboxes and radio buttons provide a boolean
(Java type "Boolean").</simpara>
<simpara>XSWT also allows filling up the widgets with default values, but this feature
should be used with care, because the defaults set in XSWT may not make it
to the file templates! This is so because if the user clicks Finish early,
the rest of the wizard pages (and their widgets) may not be created at all,
so values set in the XSWT will take no effect.</simpara>
<simpara>For this reason, defaults should ALWAYS be set in the property file. To do so,
simply use a key with the ID of the widget; those values will be written
into the wizard page when the page is created. For example, if you have a
text widget with <literal>id="numNodes"</literal> and a checkbox with <literal>id="generateTraffic"</literal>, then
the following lines</simpara>
<literallayout class="monospaced">numNodes = 100
generateTraffic = true</literallayout>
<simpara>will fill in the text widget with "100" and select the checkbox. Widgets that
do not have such lines in the property file will be left alone.</simpara>
<simpara>Compound data structures (arrays, maps, and any combination of them) can be
specified in the JSON syntax (<ulink url="http://json.org">http://json.org</ulink>). They can be iterated over
in the templates, and can be used as input/output for custom compound widgets.
Examples:</simpara>
<literallayout class="monospaced">apps = ["ftp", "smtp", "news"]
layers = {"datalink":"ieee80211", "network":"ip", "transport":["tcp","udp"]}</literallayout>
<simpara>If you get an error complaining about syntax errors in a JSON entry, the
<ulink url="http://jsonlint.com">http://jsonlint.com</ulink> website can help you locate the problem.</simpara>
<simpara>The property file takes precedence over values in the XSWT file.</simpara>
<section id="_xswt_form_creation">
<title>XSWT Form Creation</title>
<simpara>Entities and attributes in an XSWT file are directly mapped to the corresponding
SWT controls and their properties. For example the <literal>&lt;styledText&gt;</literal> tag is mapped
to the StyledText SWT control. Similarly the <emphasis>text</emphasis> attribute is mapped to the
<literal>text</literal> property of the StyledText control. It is also possible to call any public
method on the control by embedding a "call" as a child tag:</simpara>
<literallayout class="monospaced">&lt;styledtext text="Hello world!"&gt;
        &lt;setFocus/&gt;
&lt;/styledText&gt;</literallayout>
<simpara>Constants in controls declared <literal>public final</literal> can be used in an XSWT file by appending
the java class name before them:</simpara>
<literallayout class="monospaced">&lt;gateChooser gateFilter="GateChooser.INOUT|GateChooser.VECTOR"/&gt;</literallayout>
<simpara>Constants in the SWT class do not need the <literal>SWT.</literal> prefix. You can use:</simpara>
<literallayout class="monospaced">&lt;button x:style="RADIO"/&gt;</literallayout>
<simpara>Children can be added to a compound control inside the <literal>&lt;x:children&gt;&lt;/x:children&gt;</literal> tags.</simpara>
<literallayout class="monospaced">&lt;group text="Hello"&gt;
  &lt;x:children&gt;
    &lt;label text="Message 1" /&gt;
    &lt;label text="Message 2" /&gt;
  &lt;/x:children&gt;
&lt;/group&gt;</literallayout>
<simpara>Layout data can also be added as a new tag inside a control element:</simpara>
<literallayout class="monospaced">&lt;text x:id="numServers" x:style="BORDER"&gt;
  &lt;layoutData x:class="GridData" horizontalAlignment="FILL" grabExcessHorizontalSpace="true"/&gt;
&lt;/text&gt;</literallayout>
<tip><simpara>An XSWT tutorial and documentation can be found at:
<ulink url="http://www.coconut-palm-software.com/the_new_visual_editor/doku.php?id=xswt:home">http://www.coconut-palm-software.com/the_new_visual_editor/doku.php?id=xswt:home</ulink></simpara></tip>
</section>
<section id="_conditional_controls">
<title>Conditional Controls</title>
<simpara>It is also possible to create controls conditionally.
To overcome the limitation that XSWT page descriptions are completely static,
XSWT files undergo FreeMarker template processing before giving them to the
XSWT engine for instantiation. This template processing occurs right before
the page gets displayed, so data entered on previous pages can also be
used as input for generating XSWT source. This feature can be useful to make
conditional widgets (i.e. using <literal>&lt;#if&gt;</literal> to make part of the page appear only
when a certain option has been activated on earlier pages); to create a
previously unknown number of widgets (using a <literal>&lt;#list&gt;..&lt;/#list&gt;</literal> loop);
to populate combo boxes, listboxes or other widgets with options; and more.
If the user navigates in the wizard back and forth several times (using the
Next and Back buttons), the contents of wizard pages are always re-created
with using the current values of template variables just before getting
displayed, so they will always be up to date.</simpara>
</section>
</section>
<section id="_extending_the_wizards_in_java">
<title>Extending the Wizards in Java</title>
<section id="_creating_wizard_pages">
<title>Creating Wizard Pages</title>
<simpara>Defining a wizard page in Java requires that you install the Eclipse PDE
(Plug-in Development Environment), and that you have some Eclipse development skills.</simpara>
<simpara>The <literal>template.properties</literal> key for denoting a Java-based wizard page is <literal>page.&lt;NN&gt;.class</literal>,
and the value should be the fully qualified name of the Java class that implements
the wizard page. The requirements for the class are:
  - the class must be accessible to the class loader
  - the class must extend <literal>org.omnetpp.common.wizard.ICustomWizardPage;</literal>
  - the class must have a public constructor with the following argument list:
    (<literal>String name, IContentTemplate creatorTemplate, String condition</literal>)</simpara>
</section>
<section id="_creating_custom_widgets">
<title>Creating Custom Widgets</title>
<simpara>Since XSWT works via Java reflection, your own custom widgets can be used
the forms very much like normal SWT widgets. No glue or registration code
is needed, just add their package to the <literal>&lt;import&gt;</literal> tags at the top of the XSWT
file.</simpara>
<simpara>However, some Java code is needed so that the wizard knows how to write
template variables into your widgets and how to extract them after editing.
This functionality can be added via the <literal>org.omnetpp.common.wizard.IWidgetAdapter</literal>
interface. This interface must be implemented either by the widget class
itself, or by a class named <literal>&lt;widgetclass&gt;Adapter</literal> in the same package.
The interface has methods to tell whether the adapter supports a given widget,
to read the value out of the widget, and to write a value into the widget.</simpara>
<simpara>In addition to basic data types (<literal>Boolean, Integer, Double, String, etc</literal>),
it is possible to use compound data types as well, i.e. those composed of
the List and Map interfaces of the Java Collections API. The default values
can be given in the template.properties file in the JSON notation, and the
result can be used in the templates (iteration via <literal>&lt;#list&gt;</literal>, etc).</simpara>
<simpara>Jar files placed into the plugins/ subdirectory of an OMNeT++ project will be
loaded automatically, and will be available for all templates. Jar files in
that directory may be plain Java jars and Eclipse plug-in jars. (The latter
makes it also possible to contribute new functionality into the IDE via
various extension points, but this is outside the scope of this discussion
about wizards.)</simpara>
<simpara>Jar files placed in the folder of the template will
be loaded automatically when the template is used, and the classes in it will
be available for that template. Custom SWT widget classes can be imported and
used in XSWT forms, and other code can be used in the template files via the
bean wrapper (e.g. <literal>${classes["org.example.SomeClass"].someStaticMethod(...)}</literal>,
see the example wizards.) Like .xswt files and <literal>template.properties</literal>, jar files
are not copied over into the destination folder when the wizard executes.</simpara>
</section>
<section id="_extending_the_template_processing">
<title>Extending the Template Processing</title>
<simpara>If you are skilled in writing Eclipse plug-ins, there are ways you can extend
content templates. One is to contribute to the <literal>org.omnetpp.common.wizard.templatecontributor</literal>
extension point, which lets you supply <literal>IContentTemplateContributor</literal> objects
that can extend the content template implementation in various ways. You can
contribute new variables, functions or macros to the template context.</simpara>
</section>
</section>
<section id="_common_pitfalls">
<title>Common Pitfalls</title>
<itemizedlist>
<listitem>
<simpara>
Variables need to be defined. Referring to an undefined variable is an
   error in FreeMarker, i.e. it does not return empty string as in bash or
   in makefiles.
</simpara>
</listitem>
<listitem>
<simpara>
Default values should be given in template.properties! You need to resist
   the temptation to define them in the XSWT page by pre-filling the corresponding
   widget (e.g. <literal>&lt;text x:id="n" text="100"&gt;</literal>). If you specify the value in a page,
   the assignment will not take effect if the user skips that page (i.e. clicks
   Finish earlier). That causes variable to remain undefined, resulting in a
   runtime error during template processing.
</simpara>
</listitem>
<listitem>
<simpara>
Type mismatch. Variables have types in FreeMarker, and one can get type conversion
   errors if the templates are not programmed carefully; for example, comparing a number
   and a string is a runtime error. Worse, widgets in wizard pages may implicitly
   perform type conversion. For example, a numHosts=100 line in template.properties
   defines a number, but if you have a <literal>&lt;text x:id="numHosts"/&gt;</literal> widget in the form,
   the variable will come back from it as a string. Even worse, whether the
   number&#8594;string conversion takes place will depend on whether the page gets
   displayed in the wizard session or not. Therefore, it is recommended that
   you explicitly convert numeric variables to numbers at the top of templates,
   for example like this: <literal>&lt;#assign numHosts = numHosts?number&gt;</literal>
</simpara>
</listitem>
<listitem>
<simpara>
For some reason, FreeMarker refuses to print boolean variables, i.e. <literal>$\{isFoo}</literal>
   results in a runtime error. The common workaround is to write
   <literal>&lt;#if isFoo&gt;true&lt;#else&gt;false&lt;/#if&gt;</literal>; this can be shortened with our iif() function:
   <literal>${isFoo, "true", "false"}</literal>.
</simpara>
</listitem>
<listitem>
<simpara>
Many string operations are available both as builtin FreeMarker operators
   (varname?trim) and as Java methods via  FreeMarkers&#8217;s BeanWrapper (<literal>varname.trim()</literal>).
   If you are mixing the two, it is possible that you&#8217;ll start getting
   spurious errors for the Java method calls. In that case, simply change
   Java method calls to FreeMarker builtins, and all will be well.
</simpara>
</listitem>
<listitem>
<simpara>
Some Java functionality (the instanceof operator, <literal>Class.newInstance()</literal>, etc)
   cannot be accessed via BeanWrapper. If you hit such a limitation, check
   our LangUtils class that provides FreeMarker-callable static methods
   to plug these holes.
</simpara>
</listitem>
</itemizedlist>
</section>
<section id="_xswt_tips_and_trick">
<title>XSWT Tips and Trick:</title>
<variablelist>
<varlistentry>
<term>
How can I make a checkbox or radio button? <literal>&lt;checkbox&gt;</literal> and <literal>&lt;radio&gt;</literal> are not recognized in my XSWT files! 
</term>
<listitem>
<simpara>
   They are called <literal>&lt;button x:style="CHECK"&gt;</literal> and <literal>&lt;button x:style="RADIO"&gt;</literal> in SWT.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
My text fields, combo boxes etc look strange, what do I do wrong?
</term>
<listitem>
<simpara>
   You usually want to add the BORDER option, like this: <literal>&lt;text x:style="BORDER"&gt;</literal>
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
How to make a long label wrap nicely?
</term>
<listitem>
<simpara>
   You will find that specifying x:style="WRAP" is necessary, but not enough. It is
   also needed that the label widget expands and fills the space horizontally:
</simpara>
<literallayout class="monospaced">&lt;label text="Some long text...." x:style="WRAP"&gt;
    &lt;layoutData x:class="GridData" horizontalAlignment="FILL" grabExcessHorizontalSpace="true"/&gt;
&lt;/label&gt;</literallayout>
</listitem>
</varlistentry>
<varlistentry>
<term>
How to set the focus?
</term>
<listitem>
<simpara>
   Add <literal>&lt;setFocus/&gt;</literal> to the XML body of the desired widget.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
How to make widgets conditional on some previous input?
</term>
<listitem>
<simpara>
   You can use <literal>&lt;#if&gt;</literal> and other FreeMarker directives in XSWT files. These
   files undergo template processing each time the corresponding page
   appears.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
How to carry forward data from a previous page to the next?
</term>
<listitem>
<simpara>
   Use FreeMarker variables (<literal>$\{varName}</literal>) in the page.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
How can I fill a combo box with values that I&#8217;ll only know at runtime?
</term>
<listitem>
<simpara>
   You can generate the <literal>&lt;option&gt;</literal> children of the combo using FreeMarker
   directives, e.g. <literal>&lt;#list&gt;...&lt;/#list&gt;</literal>
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
How can I have some more sophisticated user input than simple textedit fields and checkboxes?
</term>
<listitem>
<simpara>
   You can implement custom SWT controls in Java, and use them in the
   wizard pages. The custom controls may even be packaged into jar files
   in the template&#8217;s directory, i.e. you do not need to write a separate
   Eclipse plug-in or something. Have a look at the source files of the
   existing custom controls (`FileChooser, NedTypeChooser, InfoLink, etc).
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
How to dynamically enable/disable controls on a page, depending on other controls (i.e. a checkbox or radio button)
</term>
<listitem>
<simpara>
   Currently you cannot. If you are desperate, you have the following options:
   (1) put the dependent controls onto a separate page, which you can make
   conditional; (2) write a custom CheckboxComposite control in Java
   that features a checkbox, and enables/disables child controls
   when the checkbox selection changes; (3) write the full custom wizard
   page entirely in Java, and register it in <literal>template.properties</literal> with
   page.xx.class= instead of page.xx.file; (4) implement scripting support
   for XSWT 1.x and contribute the patch to us :)
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
In the Project wizard, how does it get decided which templates get offered if the "with C++ checkbox" gets selected or not selected on the first page?
</term>
<listitem>
<simpara>
   If the C<literal> support checkbox is cleared, templates that require
   C</literal> support will not appear; when it is checked, there is no
   such filtering. A template is regarded as one that requires C++ support
   if the template.properties file contains any of the following:
   <literal>sourceFolders=, makemakeOptions=, or requiresCPlusPlus=true</literal>.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_using_the_ide">
<title>Using the IDE</title>
<section id="_editing_xswt_files">
<title>Editing XSWT Files</title>
<simpara>Double-clicking on an XSWT file will open it in the XSWT editor. The editor
provides basic syntax highlighting. An extremely
useful feature of the IDE is the XSWT Preview, where you can preview
the form being edited (it updates when you save the file). The Preview should
open automatically when you open the XSWT file; if it does not (or you close it),
you can access it via the <literal>Window|Show View...</literal> menu item.</simpara>
<simpara>Some (custom) widgets may not appear in the Preview; this is because the
Preview does not load jar files from the projects.</simpara>
</section>
<section id="_editing_template_files">
<title>Editing Template Files</title>
<simpara>The Freemarker Editor is opened when you double-click files with the ftl or
fti extension. (The latter stands for Freemarker Template Include, and it is
intended for template fragments that you include into other templates. Otherwise
the wizard ignores fti files, i.e. does not copy them into the new project or
folder.) The Freemarker Editor offers basic syntax highlight, validation
(error markers appear during editing if the template is not syntactically
correct), and basic content assist. Content assist can help you with directives
(<literal>&lt;#...&gt;</literal> syntax) and builtin operations (like <literal>?number, ?size, ?default</literal>, etc).
The content assist popup appears automatically when you type <emphasis>&lt;#</emphasis> (actually
a closing <emphasis>&gt;</emphasis> is also needed for the editor to recognize the tag), and
when you hit <emphasis>?</emphasis> within a directive or an interpolation (${&#8230;}).</simpara>
</section>
</section>
<section id="_append_a_predefined_template_variables">
<title>Append. A: Predefined Template Variables</title>
<informaltable
frame="all"
rowsep="1" colsep="1"
>
<tgroup cols="7">
<colspec colname="col_1" colwidth="35*"/>
<colspec colname="col_2" colwidth="10*"/>
<colspec colname="col_3" colwidth="15*"/>
<colspec colname="col_4" colwidth="10*"/>
<colspec colname="col_5" colwidth="10*"/>
<colspec colname="col_6" colwidth="10*"/>
<colspec colname="col_7" colwidth="10*"/>
<tbody>
<row>
<entry align="left" valign="top"><simpara>variable name</simpara></entry>
<entry align="center" valign="top"><simpara>project</simpara></entry>
<entry align="center" valign="top"><simpara>simulation</simpara></entry>
<entry align="center" valign="top"><simpara>msgfile</simpara></entry>
<entry align="center" valign="top"><simpara>inifile</simpara></entry>
<entry align="center" valign="top"><simpara>nedfile</simpara></entry>
<entry align="center" valign="top"><simpara>wizard</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>addProjectReference</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>author</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>date</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>licenseCode</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>licenseText</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>makemakeOptions</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>msgTypeName</literal></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>namespaceName</literal></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>nedPackageName</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>nedSourceFolders</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>newWizardName</literal></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>newWizardProject</literal></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>projectName</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>PROJECTNAME</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>projectname</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>rawProjectName</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>requiresCPlusPlus</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>simulationFolderName</literal></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>simulationName</literal></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>sourceFolders</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>targetFileName</literal></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>targetFolder</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>targetMainFile</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>targetTypeName</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>templateCategory</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>templateDescription</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>templateFolderName</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>templateFolderPath</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>templateName</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>templateProject</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>templateURL</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>withCplusplusSupport</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
<entry align="center" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>wizardType</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>year</literal></simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
<entry align="center" valign="top"><simpara>X</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
<simpara>In this section we describe the individual wizard types and their supported
template variables. Variables will be marked with one or more letter to show in
which wizard types they are supported as shown on in the previous table
(A: supported in all wizards; P: project;S:: simulation; M: messagefile; I: inifile;
N: nedfile, simplemodule, compoundmodule, network; W: wizard).</simpara>
<section id="_general">
<title>General</title>
<variablelist>
<varlistentry>
<term>
date (A)
</term>
<listitem>
<simpara>
current date in yyyy-mm-dd format
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
year (A)
</term>
<listitem>
<simpara>
year in yyyy format
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
author (A)
</term>
<listitem>
<simpara>
user name ("user.name" Java system property)
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
licenseCode (A)
</term>
<listitem>
<simpara>
license identifier for the @license NED property
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
licenseText (A)
</term>
<listitem>
<simpara>
copyright notice for the given license
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
bannerComment (A)
</term>
<listitem>
<simpara>
banner comment for source files; includes license text
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_template_information">
<title>Template information</title>
<variablelist>
<varlistentry>
<term>
wizardType (A)
</term>
<listitem>
<simpara>
the type of the wizard. Any of the following:
                 project, simulation, nedfile, inifile, messagefile,
                 simplemodule, compoundmodule, network, wizard
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
templateName (A)
</term>
<listitem>
<simpara>
name of the template
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
templateDescription (A)
</term>
<listitem>
<simpara>
template description
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
templateCategory (A)
</term>
<listitem>
<simpara>
template category
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
templateURL (A)
</term>
<listitem>
<simpara>
the URL the template was loaded from (Only for built-in and
                  other URL-based wizards)
</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>The following variables are only defined if the template was loaded from the workspace
(i.e. a project&#8217;s templates/ subdirectory):</simpara>
<variablelist>
<varlistentry>
<term>
templateFolderName (A)
</term>
<listitem>
<simpara>
name of the folder (without path) in which the template files are
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
templateFolderPath (A)
</term>
<listitem>
<simpara>
full workspace path of the folder in which the template files are
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
templateProject (A)
</term>
<listitem>
<simpara>
name of the project that defines the template
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_file_name_related_variables">
<title>File name related variables</title>
<variablelist>
<varlistentry>
<term>
targetFolder (A)
</term>
<listitem>
<simpara>
the project or folder path in which the project will generate files.
   For project wizards, this holds the name of the project being created; for
   file wizards, it holds the name of the folder in which the file will be created;
   for simulation wizard, it holds the name of the folder where files will be created.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
targetFileName (NIM)
</term>
<listitem>
<simpara>
the name of the new file to be created
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
targetTypeName (PSNIM)
</term>
<listitem>
<simpara>
a typename that can be used as the main <emphasis>type</emphasis> for the resulting code.
                         (for P = ${projectName}, for S = ${simulationName}, for NIM = ${targetFileName}) // XXX revise
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
targetMainFile (PSNIM)
</term>
<listitem>
<simpara>
a file name that can be used as the <emphasis>main</emphasis> output file for the template
                         (for PS = ${targetTypeName}.ned, for NIM = ${targetFileName})
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_project_name_related_variables">
<title>Project name related variables</title>
<variablelist>
<varlistentry>
<term>
rawProjectName (A)
</term>
<listitem>
<simpara>
the project name, "as is"
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
projectName (A)
</term>
<listitem>
<simpara>
sanitized project name with first letter capitalized
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
projectname (A)
</term>
<listitem>
<simpara>
sanitized project name in all lowercase
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
PROJECTNAME (A)
</term>
<listitem>
<simpara>
sanitized project name in all uppercase
</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>sanitization means making the name suitable as a NED or C/C++ identifier
(spaces, punctuation and other unfit chars replaced with underscore, etc.)</simpara>
</section>
<section id="_c_project_control">
<title>C++ project control</title>
<variablelist>
<varlistentry>
<term>
addProjectReference (P)
</term>
<listitem>
<simpara>
if true, make project as dependent on this one
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
sourceFolders (P)
</term>
<listitem>
<simpara>
source folders to be created and configured
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
makemakeOptions (P)
</term>
<listitem>
<simpara>
makemake options, as "folder1:options1,folder2:options2,&#8230;"
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
withCplusplusSupport (P)
</term>
<listitem>
<simpara>
whether the project supports C++ code compilation  // FIXME do we need both?
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
requiresCPlusPlus (P)
</term>
<listitem>
<simpara>
if true, the wizard requires the "support C++ option" during the project creation
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
namespaceName (SNM)
</term>
<listitem>
<simpara>
the namespace where C++ classes should be placed
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_ned_files_and_message_files">
<title>NED files and message files</title>
<variablelist>
<varlistentry>
<term>
nedSourceFolders (P)
</term>
<listitem>
<simpara>
NED source folders to be created and configured
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
nedPackageName (PSNI)
</term>
<listitem>
<simpara>
(P: ${projectname}, SNI:autocalculated)
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
msgTypeName (M)
</term>
<listitem>
<simpara>
the name of the message class
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_variables_specific_to_new_simulation_wizards">
<title>Variables specific to New Simulation wizards</title>
<variablelist>
<varlistentry>
<term>
simulationFolderName (S)
</term>
<listitem>
<simpara>
the folder where the simulation will be created
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
simulationName (S)
</term>
<listitem>
<simpara>
the name of the simulation
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_variables_for_new_wizard_generation">
<title>Variables for New Wizard generation</title>
<variablelist>
<varlistentry>
<term>
newWizardName (W)
</term>
<listitem>
<simpara>
the name of the new wizard to be created
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
newWizardProject (W)
</term>
<listitem>
<simpara>
the project where the new wizard will be created
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_miscellaneus">
<title>Miscellaneus</title>
<simpara>The variables below are just for advanced use only. They can be used to access
directly all known NED and message types, static classes for utility functions and
the whole context used during template processing.</simpara>
<variablelist>
<varlistentry>
<term>
creationContext (A)
</term>
<listitem>
<simpara>
The template evaluation context. Provided for low level access.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
classes (A)
</term>
<listitem>
<simpara>
Access to class static models. It is possible to access
                      class static methods via this variable.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
nedResources (A)
</term>
<listitem>
<simpara>
all currently known NED types
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
msgResources (A)
</term>
<listitem>
<simpara>
all currently known message types
</simpara>
</listitem>
</varlistentry>
</variablelist>
<note><simpara>In addition to the above variables, all keys found in the template.properties file
are added automatically to the context as a template variable.</simpara></note>
</section>
</section>
<section id="_append_b_functions_classes_and_macros_available_from_templates">
<title>Append. B: Functions, Classes and Macros available from Templates</title>
<variablelist>
<varlistentry>
<term>
iif(condition, valueIfTrue, valueIfFalse)
</term>
<listitem>
<simpara>
   Inline if. The FreeMarker language does not have a conditional operator
   (like ?: of C/C<literal>), but the iif() function can save you from the verbosity
   of having to spell out &lt;#if&gt;..&lt;#else&gt;..&lt;/#if&gt; everywhere such thing is needed.
   Note that unlike in C/C</literal> the evaluation is not lazy, i.e. both the "then" and
   the "else" expressions are always evaluated.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
&lt;@do expression !&gt;
</term>
<listitem>
<simpara>
   FreeMarker does not have a construct for calling a function and then discarding
   the result. One could use &lt;#assign dummy = expression&gt;, but this, apart from
   being ugly, will fail if the called (Java) function is void or returns null.
   We recommend our small "@do" macro which takes one argument and does nothing,
   and the exclamation mark (the FreeMarker default value operator) cures the
   void/null problem.
</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>The following Java classes are available during template processing:
  Math::                    java.lang.Math
  StringUtils::     org.apache.commons.lang.StringUtils
  CollectionUtils::     org.apache.commons.lang.CollectionUtils
  WordUtils::       org.apache.commons.lang.CollectionUtils
  FileUtils::       see below for documentation
  IDEUtils::        see below for documentation
  LangUtils::       see below for documentation</simpara>
<simpara>Example template code:</simpara>
<literallayout class="monospaced">The value of 10*cos(0.2) is ${10*Math.cos(0.2)}.</literallayout>
<literallayout class="monospaced">Conditional output: ${iif(condition,"yes","no")}</literallayout>
<literallayout class="monospaced">Create an empty file:
&lt;@do FileUtils.createFile("empty.txt", "")!/&gt;</literallayout>
<literallayout class="monospaced">The words of the sentence '${sentence}':
&lt;#list StringUtils.split(sentence) as word&gt;
   ${word}
&lt;/#list&gt;</literallayout>
<literallayout class="monospaced">Properties in the file ${filename}:
&lt;#assign props = FileUtils.readPropertyFile(filename)&gt;
&lt;#list props?keys as key&gt;
   ${key} ==&gt; ${props.get(key)}
&lt;/#list&gt;</literallayout>
<section id="_math">
<title>Math:</title>
<simpara>Represents the Java Math class, which contains mathematical functions.
See <ulink url="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Math.html">http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Math.html</ulink></simpara>
<simpara>Math functions:</simpara>
<literallayout class="monospaced">double cos(double x)</literallayout>
<literallayout class="monospaced">double sin(double x)</literallayout>
<literallayout class="monospaced">double pow(double x, double y)</literallayout>
<simpara>etc.</simpara>
</section>
<section id="_stringutils">
<title>StringUtils</title>
<simpara>Represents the Apache Commons StringUtils class, which contains over a hundred
utility functions for manipulating strings.
See <ulink url="http://commons.apache.org/lang/api/org/apache/commons/lang/StringUtils.html">http://commons.apache.org/lang/api/org/apache/commons/lang/StringUtils.html</ulink></simpara>
<simpara>StringUtils methods</simpara>
<literallayout class="monospaced">boolean isEmpty(String s)</literallayout>
<literallayout class="monospaced">boolean isBlank(String s)</literallayout>
<literallayout class="monospaced">String capitalize(String s)</literallayout>
<literallayout class="monospaced">String upperCase(String s)</literallayout>
<literallayout class="monospaced">String lowerCase(String s)</literallayout>
<literallayout class="monospaced">boolean startsWith(String s, String suffix)</literallayout>
<literallayout class="monospaced">boolean endsWith(String s, String prefix)</literallayout>
<literallayout class="monospaced">String[] split(String s)</literallayout>
<literallayout class="monospaced">String join(String[] strings)</literallayout>
<simpara>etc.</simpara>
</section>
<section id="_wordutils">
<title>WordUtils</title>
<simpara>Represents the Apache Commons WordUtils class, which contains utility functions
for manipulating strings as word sequences.
See <ulink url="http://commons.apache.org/lang/api/org/apache/commons/lang/WordUtils.html">http://commons.apache.org/lang/api/org/apache/commons/lang/WordUtils.html</ulink></simpara>
<simpara>WordUtils methods</simpara>
<literallayout class="monospaced">String wrap(String str, int wrapLength)</literallayout>
<literallayout class="monospaced">String capitalize(String str)</literallayout>
<literallayout class="monospaced">String swapCase(String str)</literallayout>
<simpara>etc.</simpara>
</section>
<section id="_collectionutils">
<title>CollectionUtils</title>
<simpara>Represents the Apache Commons CollectionUtils class, which contains some useful
functions for manipulating collections (like lists). Functions include computing
set union, intersection, and difference.
See <ulink url="http://commons.apache.org/collections/apidocs/org/apache/commons/collections/CollectionUtils.html">http://commons.apache.org/collections/apidocs/org/apache/commons/collections/CollectionUtils.html</ulink></simpara>
<simpara>CollectionUtils methods</simpara>
<literallayout class="monospaced">Collection union(Collection a, Collection b)</literallayout>
<literallayout class="monospaced">Collection intersection(Collection a, Collection b)</literallayout>
<literallayout class="monospaced">Collection subtract(Collection a, Collection b)</literallayout>
<simpara>etc.</simpara>
</section>
<section id="_fileutils">
<title>FileUtils:</title>
<simpara>Contains utility functions for reading files in the following formats: XML,
JSON, CSV, property file, and functions to read and return a text file
as a single string, as an array of lines, and as a an array of string arrays
(where string arrays were created by splitting each by whitespace).</simpara>
<simpara>There are two sets of functions, one works on files in the Eclipse workspace,
and the other files on "external" files, i.e. files in the file system.
Files are interpreted in the Java platform&#8217;s default encoding (unless XML files,
which specify their own encoding.)</simpara>
<simpara>FileUtils functions:</simpara>
<literallayout class="monospaced">org.w3c.dom.Document readXMLFile(String fileName)
org.w3c.dom.Document readExternalXMLFile(String fileName)</literallayout>
<simpara>Parses an XML file, and return the Document object of the resulting
DOM tree.</simpara>
<literallayout class="monospaced">Object readJSONFile(String fileName)
Object readExternalJSONFile(String fileName)</literallayout>
<simpara>Parses a JSON file. The result is a Boolean, Integer, Double, String,
List or Map, or any data structure composed of them. The JSON syntax is
documented at <ulink url="http://json.org">http://json.org</ulink>; if you want to check whether a particular
text file corresponds to the JSON syntax, use <ulink url="http://jsonlint.com">http://jsonlint.com</ulink>.</simpara>
<literallayout class="monospaced">String[][] readCSVFile(String fileName, boolean ignoreFirstLine,
                       boolean ignoreBlankLines,
                       boolean ignoreCommentLines)
String[][] readExternalCSVFile(String fileName, boolean ignoreFirstLine,
                       boolean ignoreBlankLines,
                       boolean ignoreCommentLines)</literallayout>
<simpara>Reads a CSV file. The result is an array of lines, where each line is
a string array. Additional method parameters control whether to discard the
first line of the file (which is usually a header line), whether to
ignore blank lines, and whether to ignore comment lines (those starting
with the # character). Comment lines are not part of the commonly accepted
CSV format, but they are supported here nevertheless, due to their
usefulness.</simpara>
<literallayout class="monospaced">Properties readPropertyFile(String fileName)
Properties readExternalPropertyFile(String fileName)</literallayout>
<simpara>Parses a Java property file (<emphasis>key=value</emphasis> lines) in the workspace.
The result is a Properties object, which is effectively a hash of
key-value pairs.</simpara>
<literallayout class="monospaced">String[][] readSpaceSeparatedTextFile(String fileName,
                         boolean ignoreBlankLines,
                         boolean ignoreCommentLines)
String[][] readExternalSpaceSeparatedTextFile(String fileName,
                         boolean ignoreBlankLines,
                         boolean ignoreCommentLines)</literallayout>
<simpara>Reads a text file, and return its contents, split by lines, and each line
split by whitespace. Additional method parameters control whether to ignore
blank lines and/or comment lines (those starting with the # character).
The result is an array of lines, where each line is a string array of the
items on the line.</simpara>
<literallayout class="monospaced">String[] readLineOrientedTextFile(String fileName)
String[] readExternalLineOrientedTextFile(String fileName)</literallayout>
<simpara>Reads a text file in the workspace, and returns its lines. Comment lines
(those starting with a hash mark, #) are discarded. The result is a
string array.</simpara>
<literallayout class="monospaced">String readTextFile(String fileName)
String readExternalTextFile(String fileName)</literallayout>
<simpara>Reads a text file, and return its contents unchanged as a single string.</simpara>
<literallayout class="monospaced">boolean isValidWorkspacePath(String path)</literallayout>
<simpara>Returns true if the given string is syntactically a valid workspace path.</simpara>
<literallayout class="monospaced">boolean isValidWorkspaceFilePath(String path)</literallayout>
<simpara>Returns true if the given string is syntactically a valid workspace file path.
This function does not check whether the file exists, or whether the given path
actually already points to a resource of a different type.</simpara>
<literallayout class="monospaced">IWorkspaceRoot getWorkspaceRoot()</literallayout>
<simpara>Returns the workspace root object. The workspace contains the user&#8217;s
projects.</simpara>
<literallayout class="monospaced">IProject asProject(String path)</literallayout>
<simpara>Returns the handle for the workspace project with the given name.
Throws exception if the path is not a valid workspace project path.
This function does not test whether the project exists. To test that,
call the exists() method on the returned handle.</simpara>
<literallayout class="monospaced">IContainer asContainer(String path)</literallayout>
<simpara>Returns the handle for the workspace container (i.e. project or folder) with the given name.
Throws exception if the path is not a valid workspace container path.
This function does not test whether the container exists. To test that,
call the exists() method on the returned handle.</simpara>
<literallayout class="monospaced">IFile asFile(String path)</literallayout>
<simpara>Returns the handle for the workspace file with the given name.
Throws exception if the path is not a valid workspace file path.
This function does not test whether the file exists. To test that,
call the exists() method on the returned handle.</simpara>
<literallayout class="monospaced">IResource asResource(String pathName)</literallayout>
<simpara>Returns the handle for the workspace project, folder or file with
the given name. If the resource does not exist and the path contains
more than one segment (i.e. it cannot be a project), it is returned as
a file handle if it has a file extension, and as a folder if it
does not.</simpara>
<literallayout class="monospaced">File asExternalFile(String path)</literallayout>
<simpara>Returns a java.io.File object for the given path. The object can be used to
access operations provided by the File API, such as exists(), length(), etc.</simpara>
<literallayout class="monospaced">void copy(String path, String destPath, IProgressMonitor monitor)</literallayout>
<simpara>Copies a workspace resource (file, folder or project) given with its path
to the destination path. For projects and folders, it copies recursively
(i.e. copies the whole folder tree). From the project root directory it
leaves out dot files, hidden files, and team private files.</simpara>
<literallayout class="monospaced">methods:  void copyURL(String url, String destFilePath,
                       IProgressMonitor monitor)</literallayout>
<simpara>Copies the file at the given URL to the given destination workspace file.</simpara>
<literallayout class="monospaced">methods:String createTempFile(String content)</literallayout>
<simpara>Writes the given string to a temporary file, and returns the path of the
temporary file in the file system. The file will be automatically deleted
when the IDE exits, but it can be also deleted earlier via deleteExternalFile().</simpara>
<literallayout class="monospaced">void createFile(String fileName, String content)</literallayout>
<simpara>Creates a workspaces text file with the given contents, in the platform&#8217;s default encoding.</simpara>
<literallayout class="monospaced">void createExternalFile(String fileName, String content)</literallayout>
<simpara>Creates a text file in the file system with the given contents, in the platform&#8217;s default encoding.</simpara>
<literallayout class="monospaced">void deleteFile(String fileName)</literallayout>
<simpara>Deletes the given workspace file. It is OK to invoke it on a nonexistent file.</simpara>
<literallayout class="monospaced">void deleteExternalFile(String fileName)</literallayout>
<simpara>Deletes the given file from the file system. It is OK to invoke it on a nonexistent file.</simpara>
<literallayout class="monospaced">void createDirectory(String fileName)</literallayout>
<simpara>Creates a workspace folder. The parent must exist.</simpara>
<literallayout class="monospaced">void createExternalDirectory(String fileName)</literallayout>
<simpara>Creates a directory in the file system. The parent must exist.</simpara>
<literallayout class="monospaced">void removeDirectory(String fileName)</literallayout>
<simpara>Deletes a workspace folder. The folder must be empty. It is OK to invoke
it on a nonexistent folder.</simpara>
<literallayout class="monospaced">void removeExternalDirectory(String fileName)</literallayout>
<simpara>Deletes a directory in the file system. The directory must be empty.
It is OK to invoke it on a nonexistent directory.</simpara>
</section>
<section id="_nedutils">
<title>NedUtils</title>
<simpara>Provides utility methods to work with NED types and check their existence.</simpara>
<simpara>NedUtils methods</simpara>
<literallayout class="monospaced">boolean isVisibleType(String typeName, String inFolder)</literallayout>
<simpara>Returns whether the given NED type is visible in the given folder.
If the type is a fully qualified name, it is recognized if it is
defined in the same project as the given folder, or in one of its
referenced projects; if the type is a simple name (without package),
it is recognized if it&#8217;s in the NED package of the given folder.</simpara>
<literallayout class="monospaced">INEDTypeInfo getNedType(String typeName, String inFolder)</literallayout>
<simpara>Like isVisibleNedType(), but actually returns the given NED type
if it was found; otherwise it returns null. Useful if you implement
a complex wizard page in Java.</simpara>
</section>
<section id="_ideutils">
<title>IDEUtils</title>
<simpara>Provides entry points into various aspects of the IDE. This includes access to
the Eclipse workspace (projects, folders, files), and the NED index. The former
is documented in the Eclipse Platform help; documentation for the latter can
be found in the sources (Javadoc).
See <ulink url="http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/resInt.htm">http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/resInt.htm</ulink>
and <ulink url="http://help.eclipse.org/galileo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/resources/IWorkspaceRoot.html">http://help.eclipse.org/galileo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/resources/IWorkspaceRoot.html</ulink></simpara>
<simpara>IDEUtils methods</simpara>
<literallayout class="monospaced">boolean openConfirm(String title, String message,
                            String detailsMessage)
boolean openQuestion(String title, String message,
                             String detailsMessage)
boolean openError(String title, String message,
                          String detailsMessage)
boolean openWarning(String title, String message,
                            String detailsMessage)
boolean openInformation(String title, String message,
                            String detailsMessage)</literallayout>
<simpara>Opens a standard message dialog, with an closable details message.</simpara>
</section>
<section id="_langutils">
<title>LangUtils</title>
<simpara>Provides a collection of Java language related utility functions.</simpara>
<simpara>LangUtils methods</simpara>
<literallayout class="monospaced">boolean hasMethod(Object object, String methodName)</literallayout>
<simpara>Returns true if the object has a method with the given name.
Method args and return type are not taken into account.
Search is performed on the object&#8217;s class and all super classes.</simpara>
<literallayout class="monospaced">boolean hasField(Object object, String fieldName)</literallayout>
<simpara>Returns true if the object has a field with the given name.
Field type is not taken into account. Search is performed on
the object&#8217;s class and all super classes.</simpara>
<literallayout class="monospaced">boolean instanceOf(Object object, String classOrInterfaceName)</literallayout>
<simpara>Returns true if the given object is instance of (subclasses from or
implements) the given class or interface. To simplify usage, the class
or interface name is accepted both with and without the package name.</simpara>
<literallayout class="monospaced">String toString(Object object)</literallayout>
<simpara>Produces a user-friendly representation of the object. In case of
collections (lists, maps, etc), the representation is JSON-like.</simpara>
<literallayout class="monospaced">List&lt;Object&gt; newList()</literallayout>
<simpara>Creates and returns a new mutable List object (currently ArrayList).</simpara>
<literallayout class="monospaced">Map&lt;Object, Object&gt; newMap()</literallayout>
<simpara>Creates and returns a new mutable Map object (currently HashMap).</simpara>
<literallayout class="monospaced">Set&lt;Object&gt; newSet()</literallayout>
<simpara>Creates and returns a new mutable Set object (currently HashSet).</simpara>
<literallayout class="monospaced">Class&lt;?&gt; getClass(Object object)</literallayout>
<simpara>Returns the class of the given object. Provided because BeanWrapper
seems to have a problem with the getClass() method.</simpara>
</section>
<section id="_processutils">
<title>ProcessUtils</title>
<literallayout class="monospaced">ProcessResult exec(String command, String[] arguments,
                           String workingDirectory,
                           String standardInput, double timeout)</literallayout>
<simpara>Executes the given command with the arguments as a separate process.
The standard input is fed into the spawn process and the output is read
until the process finishes or timeout occurs. The timeout value 0 means wait
infinitely long to finish the process. Arguments at the end of the argument
list are optional.</simpara>
<literallayout class="monospaced">String lookupExecutable(String name)</literallayout>
<simpara>Finds the given executable in the path, and returns it with full path.
If not found, it returns the original string.</simpara>
<simpara>TODO document what are the variables nedResources and msgResources; write a few examples about their usage</simpara>
<simpara>TODO document glob patterns in verbatimFiles etc</simpara>
<simpara>TODO show how to write templates that are suitable for more than one wizard.</simpara>
<simpara>TODO check: BeanWrapper cannot access inherited methods? (e.g. toString())</simpara>
<simpara>TODO tutorial: XSWT, FTL, how to edit stuff; how to use Java classes (new widgets in XSWT,
JARs in the templates)</simpara>
<simpara>TODO add a little nutshell XSWT tutorial!</simpara>
<simpara>TODO also some minimal FreeMarker tutorial (variables are ${}, there is &lt;#if&gt;,
  &lt;#list&gt;; and there&#8217;s lots more, see the manual and/or the provided examples</simpara>
<simpara>TODO document export/import wizards</simpara>
</section>
</section>
</chapter>
