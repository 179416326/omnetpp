\chapter{Eventlog}
\label{cha:eventlog}

\section{Introduction}
The eventlog feature and the related tools are completely new in OMNeT++ 4.0. They aim to
help understanding complex simulation models and to help correctly implementing the
desired component behaviors. Using these tools you will be able to easily examine every
minute detail of the simulation back and forth in terms of simulation time or step-by-step
focusing on the behavior instead of the statistical results of your model.

The eventlog file is created automatically during a simulation run upon explicit request
configurable in the ini file. The resulting file can be viewed in the OMNeT++ IDE using
the Sequence Chart and the Eventlog Table Tools or can be processed by the command line
Eventlog Tool. These tools support filtering the collected data to show you only the
relevant parts focusing on what you are looking for. They allow examining causality
relationships and provide filtering based on simulation times, event numbers, modules and
messages.

The simulation kernel records into the eventlog among others: user level messages,
creation and deletion of modules, gates and connections, scheduling of self messages,
sending of messages to other modules either through gates or directly and processing of
messages (that is events). Optionally detailed message data can also be automatically
recorded based on a message filter. The result is an eventlog file which contains detailed
information of the simulation run and later can be used for various purposes.

\begin{note}
The eventlog file may become quite large for long running simulations (often hundreds of
Mbytes but occasionally multiple Gbytes), because it contains a lot of information about
the run especially when message detail recording is turned on.
\end{note}

\section{Configuration}
To record an eventlog file during the simulation, simply insert the following line into
the ini file.
\begin{verbatim}
record-eventlog = true
\end{verbatim}
\begin{note}
Since writing an eventlog file might significantly decrease overall simulation performance
therefore eventlog recording is turned off by default.
\end{note}

\subsection{File Name}
The simulation kernel will write the eventlog file during the simulation into the file
specified by the following ini file configuration entry (showing the default file name
pattern here):
\begin{verbatim}
eventlog-file = ${resultdir}/${configname}-${runnumber}.log
\end{verbatim}

\subsection{Recording Intervals}
The size of an eventlog file is approximately proportional to the number of events it
contains. To reduce the file size and speed up the simulation it might be useful to record
only certain events. The following ini file configuration entry instructs the kernel to
record events with simulation time less than 10.2, between 22.2 and 100 and greater than
233.3.
\begin{verbatim}
eventlog-recording-intervals = ..10.2, 22.2..100, 233.3..
\end{verbatim}

\subsection{Recording Modules}
Another factor that affects the size of an eventlog file is the number of modules for
which the simulation kernel records events during the simulation. The following ini file
configuration entry instructs the kernel to record only the events that occurred in any of
the routers having index between 10 and 20 while turns off recording for all other
modules. This configuration key makes sense only for simple modules.
\begin{verbatim}
**.router[10..20].**.module-eventlog-recording = true
**.module-eventlog-recording = false
\end{verbatim}

\subsection{Recording Message Data}
Since recording message data dramatically increases the size of the eventlog file and
additionally slows down the simulation therefore it is turned off by default even if
writing the eventlog is enabled. To turn on message data recording enter a value for the
following configuration key in the ini file:
\begin{verbatim}
eventlog-message-detail-pattern
\end{verbatim}
An example configuration for an IEEE 80211 model that records the field encapsulationMsg
and all other fields which name ends with Address from messages which class name ends with
Frame looks like this:
\begin{verbatim}
eventlog-message-detail-pattern = *Frame:encapsulatedMsg,*Address
\end{verbatim}
An example configuration for a TCP/IP model that records the port and address fields in
all network packets looks like the following:
\begin{verbatim}
eventlog-message-detail-pattern =
 PPPFrame:encapsulatedMsg|IPDatagram:encapsulatedMsg,*Address|TCPSegment:*Port
\end{verbatim}
\begin{note}
Take care about long running simulations because they might output eventlog files of
several Gbytes and thus fail due to insufficient disk space.
\end{note}

\section{Eventlog Tool}
The Eventlog Tool is a command line tool to process eventlog files. Invoking it without
parameters will display usage information such as available commands and options. The
following are the most useful commands for users.

\subsection{Filter}
The eventlog tool provides off line filtering that is usually applied to the eventlog file
after the simulation has been finished and before actually opening it in the OMNeT++ IDE
or processing by any other means. Use the filter command and its various options to
specify what should be present in the result file.

\subsection{Echo}
Since the eventlog file format is text based and users are encouraged to implement their
own filters therefore there needs to be a way to check whether an eventlog file is
correct. The echo command provides a way to check this and help users creating custom
filters. Anything not echoed back by the eventlog tool will not be taken into
consideration by the other tools found in the OMNeT++ IDE.
\begin{note}
Custom filter tools should filter out whole events only otherwise the consequences are
undefined.
\end{note}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "usman"
%%% End:
