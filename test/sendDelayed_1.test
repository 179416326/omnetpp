%name: sendDelayed_1

%description:
Basic test for cSimpleModule.sendDelayed().

%file: @TNAME@.ned

simple @TNAME@_Sender
  gates:
    out: out;
endsimple

simple @TNAME@_Receiver
  gates:
    in: in;
endsimple

module @TNAME@_Net
  submodules:
    sender : @TNAME@_Sender;
    receiver : @TNAME@_Receiver;
  connections:
    sender.out --> receiver.in;
endmodule

network @TNAME@_net : @TNAME@_Net
endnetwork

%file: @TNAME@.cc

#include "omnetpp.h"

class @TNAME@_Sender : public cSimpleModule
{
    Module_Class_Members(@TNAME@_Sender,cSimpleModule,16384)
    virtual void activity();
};

class @TNAME@_Receiver : public cSimpleModule
{
    Module_Class_Members(@TNAME@_Receiver,cSimpleModule,16384)
    virtual void activity();
};

Define_Module(@TNAME@_Sender);
Define_Module(@TNAME@_Receiver);

void @TNAME@_Sender::activity()
{
   cMessage *msg = new cMessage();
   sendDelayed(msg, 0.3456, "out");
}

void @TNAME@_Receiver::activity()
{
   cMessage *msg = receive();
   simtime_t diff = simTime() - msg->timestamp();
   ev << "diff: " << diff << endl;
}

%inifile: @TNAME@.ini
[General]
network=@TNAME@_net

%ignore-exitcode: 1

%contains: stdout
diff: 0.3456

%not-contains: stderr
Error

