%description:
Test NED index and sizeof() operators in:
 - submodule non-const parameters
 - module vector sizes

%file: {}.ned

module {Foo}
endmodule

simple {Simple}
   parameters:
      p0, p1, p2, p3, p4, p5, p6, p7, p8, p9;
endsimple

module {Compound}
    parameters:
        a: numeric;
    gates:
        in: in[];
    submodules:
        foo : {Foo}[5];
        dum1 : {Foo}[sizeof(foo)];
        dum2 : {Foo}[sizeof(in)];
        dum3 : {Foo}[a+sizeof(foo)];
        dum4 : {Foo}[a+sizeof(in)];

        sub : {Simple}[3];
            parameters:
                p0 = index,
                p1 = sizeof(foo),
                p2 = sizeof(in),
                p3 = a+index,
                p4 = a+sizeof(foo),
                p5 = a+sizeof(in),
                // print out sizeof dum1/dum2/dum3/dum4:
                p6 = sizeof(dum1),
                p7 = sizeof(dum2),
                p8 = sizeof(dum3),
                p9 = sizeof(dum4);
endmodule

// we need this only because the top-level module cannot
// have gates, and we want to test sizeof(gatevector) as well
module {Wrapper}
    submodules:
        c: {Compound};
            parameters: a=100;
            gatesizes: in[8];
    connections nocheck:
endmodule

network {network}: {Wrapper}
endnetwork

%file: {}.cc

#include <omnetpp.h>

class {Simple} : public cSimpleModule
{
    Module_Class_Members({Simple},cSimpleModule,16384)
    virtual void activity();
};

Define_Module({Simple});

void {Simple}::activity()
{
    for (int i=0; i<params(); i++)
        ev << fullName() << "." << par(i).name() << "=" << (double)par(i) << endl;
}

%contains: stdout
sub[0].p0=0
sub[0].p1=5
sub[0].p2=8
sub[0].p3=100
sub[0].p4=105
sub[0].p5=108
sub[0].p6=5
sub[0].p7=8
sub[0].p8=105
sub[0].p9=108

%contains: stdout
sub[1].p0=1
sub[1].p1=5
sub[1].p2=8
sub[1].p3=101
sub[1].p4=105
sub[1].p5=108
sub[1].p6=5
sub[1].p7=8
sub[1].p8=105
sub[1].p9=108

%contains: stdout
sub[2].p0=2
sub[2].p1=5
sub[2].p2=8
sub[2].p3=102
sub[2].p4=105
sub[2].p5=108
sub[2].p6=5
sub[2].p7=8
sub[2].p8=105
sub[2].p9=108

