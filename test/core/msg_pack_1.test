%description:
Tests parsimPack/parsimUnpack for generated classes

%file: test.msg

message TestMessage {
    int i;
    double d;
    string s;

    int iv[];
    double dv[];
    string sv[];
}


%includes:
#include <string.h>
#include "../src/sim/parsim/cfilecommbuffer.h"
#include "test_m.h"

%activity:

#define PRINT(X)  ev << #X << ":" << (X) << endl

cFileCommBuffer *buffer = new cFileCommBuffer();

TestMessage msg("msg");
msg.setI(23);
msg.setD(3.14);
msg.setS("Hello");
msg.parsimPack(buffer);

TestMessage msg2("tmp");
msg2.parsimUnpack(buffer);
ev << "isBufferEmpty:" << buffer->isBufferEmpty() << endl;
PRINT(msg2.getI());
PRINT(msg2.getD());
PRINT(msg2.getS());
ev << ".";

%contains: stdout
isBufferEmpty:1
TBD
