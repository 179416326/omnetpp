%description:
Check cXMLElement::getElementByPath() basic functionality

%file: {}.xml

<foo id="1">
    <foo id="2" color="red">one</foo>
    <bar id="3" color="red">
        <foo id="4">two</foo>
        <bar id="5">three</bar>
    </bar>
    <foo id="6">
        <bar id="7" color="red">four</bar>
        <bar id="8">five</bar>
        <bar id="9" color="yellow">
            <bar id="10" color="green" weight="heavy">six</bar>
        </bar>
    </foo>
    <bar id="11" color="green">
        <foo id="12">seven</foo>
        <bar id="13">eight</bar>
        <bar id="14">nine</bar>
        <bar id="15">ten</bar>
    </bar>
    <bar id="16">ten</bar>
</foo>

%global:

#ifdef _MSC_VER
#pragma warning(disable:4786)
#endif

static void getElement(const char *pathexpr)
{
    cXMLElement *rootelement = ev.getXMLDocument("{}.xml", NULL);
    cXMLElement *node = rootelement->getElementByPath(pathexpr, rootelement, NULL);

    ev << (!pathexpr ? "''" : pathexpr) << ": " << (!node ? "null" : node->getAttribute("id")) << "\n";
}

%activity:

//__asm int 3;

getElement(".");
getElement("././.");

getElement("./foo");
getElement("./././foo/././.");

getElement("foo");
getElement("nothing");
getElement("foo/bar");
getElement("foo/nothing");

getElement("foo/bar[0]");
getElement("foo/bar[2]");
getElement("foo/bar[3]");

getElement("foo/bar[@color='green']");
getElement("foo/bar[@id='11']");
getElement("foo/bar[1]/bar[2]");

getElement("*/bar[0]");
getElement("foo/*");

getElement("*/*/bar");
getElement("*/*[@color='green']/bar");
getElement("*/*[3]/*[1]");

getElement(".//baz");
getElement(".//bar[@color='yellow']");
getElement(".//bar[@color='green']/foo");
getElement(".//nothing");

getElement("*");
getElement("*/foo");
getElement("*/bar");
getElement("*/bar/././././.");

getElement("./*");
getElement("./*/foo");

%contains: stdout
.: null
././.: null
./foo: 1
./././foo/././.: 1
foo: 1
nothing: null
foo/bar: 3
foo/nothing: null
foo/bar[0]: 3
foo/bar[2]: 16
foo/bar[3]: null
foo/bar[@color='green']: 11
foo/bar[@id='11']: 11
foo/bar[1]/bar[2]: 15
*/bar[0]: 3
foo/*: 2
*/*/bar: 5
*/*[@color='green']/bar: 13
*/*[3]/*[1]: 13
.//baz: null
.//bar[@color='yellow']: 9
.//bar[@color='green']/foo: 12
.//nothing: null
*: 1
*/foo: 2
*/bar: 3
*/bar/././././.: 3
./*: 1
./*/foo: 2
